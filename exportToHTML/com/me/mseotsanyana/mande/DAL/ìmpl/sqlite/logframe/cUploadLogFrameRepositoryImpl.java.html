<html>
<head>
<title>cUploadLogFrameRepositoryImpl.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #8c8c8c; font-style: italic;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #1750eb;}
.s5 { color: #067d17;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
cUploadLogFrameRepositoryImpl.java</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">com.me.mseotsanyana.mande.DAL.Ã¬mpl.sqlite.logframe;</span>

<span class="s0">import </span><span class="s1">android.content.ContentValues;</span>
<span class="s0">import </span><span class="s1">android.content.Context;</span>
<span class="s0">import </span><span class="s1">android.database.sqlite.SQLiteDatabase;</span>
<span class="s0">import </span><span class="s1">android.util.Log;</span>
<span class="s0">import </span><span class="s1">android.util.Pair;</span>

<span class="s0">import </span><span class="s1">com.google.gson.Gson;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cComponentModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cRaidCategoryModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.repository.logframe.iUploadLogFrameRepository;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cCriteriaModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cQuestionGroupingModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cQuestionModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cQuestionTypeModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cActivityModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cImpactModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cInputModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cLogFrameModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cOutcomeModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cOutputModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cRaidModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.BLL.model.logframe.cResourceTypeModel;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.DAL.storage.database.cSQLDBHelper;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.DAL.storage.excel.cExcelHelper;</span>
<span class="s0">import </span><span class="s1">com.me.mseotsanyana.mande.UTIL.cConstant;</span>

<span class="s0">import </span><span class="s1">org.apache.poi.ss.usermodel.Row;</span>
<span class="s0">import </span><span class="s1">org.apache.poi.ss.usermodel.Sheet;</span>
<span class="s0">import </span><span class="s1">org.apache.poi.ss.usermodel.Workbook;</span>

<span class="s0">import </span><span class="s1">java.text.SimpleDateFormat;</span>
<span class="s0">import </span><span class="s1">java.util.HashMap;</span>
<span class="s0">import </span><span class="s1">java.util.HashSet;</span>
<span class="s0">import </span><span class="s1">java.util.Map;</span>
<span class="s0">import </span><span class="s1">java.util.Set;</span>

<span class="s0">public class </span><span class="s1">cUploadLogFrameRepositoryImpl </span><span class="s0">implements </span><span class="s1">iUploadLogFrameRepository {</span>
    <span class="s0">private static </span><span class="s1">SimpleDateFormat sdf = cConstant.FORMAT_DATE;</span>
    <span class="s0">private static </span><span class="s1">String TAG = cUploadLogFrameRepositoryImpl.</span><span class="s0">class</span><span class="s1">.getSimpleName();</span>

    <span class="s2">/* an object of the database helper */</span>
    <span class="s0">private </span><span class="s1">cSQLDBHelper dbHelper;</span>
    <span class="s2">/* an object of the excel helper */</span>
    <span class="s0">private </span><span class="s1">cExcelHelper excelHelper;</span>

    <span class="s0">public </span><span class="s1">cUploadLogFrameRepositoryImpl(Context context) {</span>
        <span class="s1">dbHelper = </span><span class="s0">new </span><span class="s1">cSQLDBHelper(context);</span>
        <span class="s1">excelHelper = </span><span class="s0">new </span><span class="s1">cExcelHelper(context);</span>
    <span class="s1">}</span>

    <span class="s2">/*#################################### LOGFRAME FUNCTIONS ####################################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts and adds the logframe data from excel.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">logFrame</span>
     <span class="s2">*/</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addLogFrameFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Sheet logFrameSheet = workbook.getSheet(cExcelHelper.SHEET_tblLOGFRAME);</span>
        <span class="s0">if </span><span class="s1">(logFrameSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row cRow : logFrameSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(cRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cLogFrameModel logFrame = </span><span class="s0">new </span><span class="s1">cLogFrameModel();</span>

            <span class="s1">logFrame.setLogFrameID(</span>
                    <span class="s1">(</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">0</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">logFrame.setOrganizationID(</span>
                    <span class="s1">(</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">1</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">logFrame.setName(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">2</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">logFrame.setDescription(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">3</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>

            <span class="s1">Set&lt;Long&gt; subLogFrameModelSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">long </span><span class="s1">parentID, childID;</span>

            <span class="s1">Sheet logFrameTreeSheet = workbook.getSheet(cExcelHelper.SHEET_tblLOGFRAMETREE);</span>
            <span class="s0">for </span><span class="s1">(Row rowLogFrameTree : logFrameTreeSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowLogFrameTree.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s1">parentID = (</span><span class="s0">int</span><span class="s1">) rowLogFrameTree.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(logFrame.getLogFrameID() == parentID) {</span>
                    <span class="s1">childID = (</span><span class="s0">int</span><span class="s1">) rowLogFrameTree.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">subLogFrameModelSet.add(childID);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s0">if </span><span class="s1">(!addLogFrameFromExcel(logFrame, subLogFrameModelSet)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds the logframe and sub-logframe data from excel.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">logFrameModel  logFrame</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">subLogFrameSet sub logFrame set</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addLogFrameFromExcel(cLogFrameModel logFrameModel, Set&lt;Long&gt; subLogFrameSet) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, logFrameModel.getLogFrameID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ORGANIZATION_FK_ID, logFrameModel.getOrganizationID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_NAME, logFrameModel.getName());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DESCRIPTION, logFrameModel.getDescription());</span>

        <span class="s2">// insert LogFrame record</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblLOGFRAME, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add subLogFrame</span>
            <span class="s0">for </span><span class="s1">(</span><span class="s0">long </span><span class="s1">childID : subLogFrameSet) {</span>
                <span class="s0">if </span><span class="s1">(!addLogFrameTree(logFrameModel.getLogFrameID(), childID))</span>
                    <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing LOGFRAME from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds the sub-logframe data from excel.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">parentID parent identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">childID  child identification</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addLogFrameTree(</span><span class="s0">long </span><span class="s1">parentID, </span><span class="s0">long </span><span class="s1">childID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, parentID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_CHILD_FK_ID, childID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblLOGFRAMETREE, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteLogFrame() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblLOGFRAME, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteLogFrameTree() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblLOGFRAMETREE, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/*################################## RESOURCE TYPE FUNCTIONS #################################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts resource type data from excel and adds it to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addResourceTypeFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Sheet RTSheet = workbook.getSheet(cExcelHelper.SHEET_tblRESOURCETYPE);</span>

        <span class="s0">if </span><span class="s1">(RTSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row cRow : RTSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(cRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cResourceTypeModel resourceTypeModel = </span><span class="s0">new </span><span class="s1">cResourceTypeModel();</span>

            <span class="s1">resourceTypeModel.setResourceTypeID((</span><span class="s0">int</span><span class="s1">)</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">0</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">resourceTypeModel.setName(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">1</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">resourceTypeModel.setDescription(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">2</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>

            <span class="s0">if </span><span class="s1">(!addResourceType(resourceTypeModel)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds resource type data to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">resourceTypeModel resource type model</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addResourceType(cResourceTypeModel resourceTypeModel) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, resourceTypeModel.getResourceTypeID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_NAME, resourceTypeModel.getName());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DESCRIPTION, resourceTypeModel.getDescription());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblRESOURCETYPE, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing RESOURCE TYPE from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteResourceTypes() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblRESOURCETYPE, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/* ################################### COMPONENT FUNCTIONS ###################################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts and adds the impact data from excel.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addComponentFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Workbook awpbWorkbook = excelHelper.getWorkbookAWPB();</span>

        <span class="s1">Sheet componentSheet = workbook.getSheet(cExcelHelper.SHEET_tblCOMPONENT);</span>

        <span class="s1">Sheet impactSheet = workbook.getSheet(cExcelHelper.SHEET_tblIMPACT);</span>
        <span class="s1">Sheet outcomeSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTCOME);</span>
        <span class="s1">Sheet outputSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTPUT);</span>
        <span class="s1">Sheet activitySheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITY);</span>
        <span class="s1">Sheet inputSheet = workbook.getSheet(cExcelHelper.SHEET_tblINPUT);</span>

        <span class="s1">Sheet OISheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTCOME_IMPACT);</span>
        <span class="s1">Sheet OOSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTPUT_OUTCOME);</span>
        <span class="s1">Sheet AOSheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITY_OUTPUT);</span>
        <span class="s1">Sheet IASheet = workbook.getSheet(cExcelHelper.SHEET_tblINPUT_ACTIVITY);</span>

        <span class="s1">Sheet PASheet = workbook.getSheet(cExcelHelper.SHEET_tblPRECEDINGACTIVITY);</span>
        <span class="s1">Sheet AASheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITYASSIGNMENT);</span>

        <span class="s1">Sheet humanSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblHUMAN);</span>
        <span class="s1">Sheet humanSetSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblHUMANSET);</span>
        <span class="s1">Sheet materialSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblMATERIAL);</span>
        <span class="s1">Sheet incomeSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblINCOME);</span>
        <span class="s1">Sheet fundSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblFUND);</span>
        <span class="s1">Sheet expenseSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblEXPENSE);</span>

        <span class="s0">if </span><span class="s1">(componentSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row cRow : componentSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(cRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cComponentModel componentModel = </span><span class="s0">new </span><span class="s1">cComponentModel();</span>

            <span class="s1">componentModel.setComponentID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">componentModel.getLogFrameModel().setLogFrameID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">componentModel.setName(cRow.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">componentModel.setDescription(cRow.getCell(</span><span class="s4">3</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>

            <span class="s2">/* impact component */</span>
            <span class="s1">Set&lt;cImpactModel&gt; impactModelSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row impactRow : impactSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(impactRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">impactID = (</span><span class="s0">int</span><span class="s1">) impactRow.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == impactID) {</span>

                    <span class="s1">cImpactModel impactModel = </span><span class="s0">new </span><span class="s1">cImpactModel();</span>

                    <span class="s1">impactModel.setComponentID(impactID);</span>
                    <span class="s1">impactModel.setParentID((</span><span class="s0">int</span><span class="s1">) impactRow.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>

                    <span class="s1">impactModelSet.add(impactModel);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">/* outcome component */</span>
            <span class="s1">Set&lt;cOutcomeModel&gt; outcomeModelSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row outcomeRow : outcomeSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(outcomeRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">outcomeID = (</span><span class="s0">int</span><span class="s1">) outcomeRow.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == outcomeID) {</span>

                    <span class="s1">cOutcomeModel outcomeModel = </span><span class="s0">new </span><span class="s1">cOutcomeModel();</span>

                    <span class="s1">outcomeModel.setComponentID(outcomeID);</span>
                    <span class="s1">outcomeModel.setParentID((</span><span class="s0">int</span><span class="s1">) outcomeRow.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
                    <span class="s1">outcomeModel.getImpactModel().setComponentID((</span><span class="s0">int</span><span class="s1">) outcomeRow.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>

                    <span class="s1">outcomeModelSet.add(outcomeModel);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">/* get impacts of the outcome for a sub-logframe */</span>
            <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; oiMap = </span><span class="s0">new </span><span class="s1">HashMap&lt;&gt;();</span>
            <span class="s2">//long parentID, childID, impactID;</span>
            <span class="s0">for </span><span class="s1">(Row rowOI : OISheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowOI.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">outcomeID = (</span><span class="s0">int</span><span class="s1">) rowOI.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == outcomeID) {</span>
                    <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; impactSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
                    <span class="s0">long </span><span class="s1">parentID = (</span><span class="s0">int</span><span class="s1">) rowOI.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">childID = (</span><span class="s0">int</span><span class="s1">) rowOI.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">impactID = (</span><span class="s0">int</span><span class="s1">) rowOI.getCell(</span><span class="s4">3</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">impactSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(outcomeID, impactID));</span>
                    <span class="s1">oiMap.put(impactSet, </span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(parentID, childID));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">/* output component */</span>
            <span class="s1">Set&lt;cOutputModel&gt; outputModelSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row outputRow : outputSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(outputRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">outputID = (</span><span class="s0">int</span><span class="s1">) outputRow.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == outputID) {</span>

                    <span class="s1">cOutputModel outputModel = </span><span class="s0">new </span><span class="s1">cOutputModel();</span>

                    <span class="s1">outputModel.setComponentID(outputID);</span>
                    <span class="s1">outputModel.setParentID((</span><span class="s0">int</span><span class="s1">) outputRow.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
                    <span class="s1">outputModel.getOutcomeModel().setComponentID((</span><span class="s0">int</span><span class="s1">) outputRow.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>

                    <span class="s1">outputModelSet.add(outputModel);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">/* get outcomes of the output for a sub-logframe */</span>
            <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; ooMap = </span><span class="s0">new </span><span class="s1">HashMap&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowOO : OOSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowOO.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">outputID = (</span><span class="s0">int</span><span class="s1">) rowOO.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == outputID) {</span>
                    <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; impactSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
                    <span class="s0">long </span><span class="s1">parentID = (</span><span class="s0">int</span><span class="s1">) rowOO.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">childID = (</span><span class="s0">int</span><span class="s1">) rowOO.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">outcomeID = (</span><span class="s0">int</span><span class="s1">) rowOO.getCell(</span><span class="s4">3</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">impactSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(outputID, outcomeID));</span>
                    <span class="s1">ooMap.put(impactSet, </span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(parentID, childID));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">/* activity component */</span>
            <span class="s1">Set&lt;cActivityModel&gt; activityModelSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row activityRow : activitySheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(activityRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">activityID = (</span><span class="s0">int</span><span class="s1">) activityRow.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == activityID) {</span>

                    <span class="s1">cActivityModel activityModel = </span><span class="s0">new </span><span class="s1">cActivityModel();</span>

                    <span class="s1">activityModel.setComponentID(activityID);</span>
                    <span class="s1">activityModel.setParentID((</span><span class="s0">int</span><span class="s1">) activityRow.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
                    <span class="s1">activityModel.getOutputModel().setComponentID((</span><span class="s0">int</span><span class="s1">) activityRow.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>

                    <span class="s1">activityModelSet.add(activityModel);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">/* get outputs of the activity for a sub-logframe */</span>
            <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; aoMap = </span><span class="s0">new </span><span class="s1">HashMap&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowAO : AOSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowAO.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">activityID = (</span><span class="s0">int</span><span class="s1">) rowAO.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == activityID) {</span>
                    <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; AOSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
                    <span class="s0">long </span><span class="s1">parentID = (</span><span class="s0">int</span><span class="s1">) rowAO.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">childID = (</span><span class="s0">int</span><span class="s1">) rowAO.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">outputID = (</span><span class="s0">int</span><span class="s1">) rowAO.getCell(</span><span class="s4">3</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">AOSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(activityID, outputID));</span>
                    <span class="s1">aoMap.put(AOSet, </span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(parentID, childID));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">/* get preceding activities of the activity*/</span>
            <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; precedingSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowPA : PASheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowPA.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">precedingActivityID = (</span><span class="s0">int</span><span class="s1">) rowPA.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == precedingActivityID) {</span>
                    <span class="s0">long </span><span class="s1">succeedingActivityID = (</span><span class="s0">int</span><span class="s1">) rowPA.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">precedingSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(precedingActivityID, succeedingActivityID));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">/* get activity assignment */</span>
            <span class="s1">Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; assignmentMap = </span><span class="s0">new </span><span class="s1">HashMap&lt;&gt;();</span>
            <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; asSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowAA : AASheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowAA.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">assignedActivityID = (</span><span class="s0">int</span><span class="s1">) rowAA.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == assignedActivityID) {</span>
                    <span class="s0">long </span><span class="s1">staffID = (</span><span class="s0">int</span><span class="s1">) rowAA.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">assignmentID = (</span><span class="s0">int</span><span class="s1">) rowAA.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">asSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(assignmentID, staffID));</span>
                    <span class="s1">assignmentMap.put(assignedActivityID, asSet);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">/* input component */</span>
            <span class="s1">Set&lt;cInputModel&gt; inputModelSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row inputRow : inputSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(inputRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">inputID = (</span><span class="s0">int</span><span class="s1">) inputRow.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == inputID) {</span>

                    <span class="s1">cInputModel inputModel = </span><span class="s0">new </span><span class="s1">cInputModel();</span>

                    <span class="s1">inputModel.setComponentID(inputID);</span>
                    <span class="s1">inputModel.getActivityModel().setComponentID((</span><span class="s0">int</span><span class="s1">) inputRow.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
                    <span class="s1">inputModel.getResourceTypeModel().setResourceTypeID((</span><span class="s0">int</span><span class="s1">) inputRow.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>

                    <span class="s1">inputModelSet.add(inputModel);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">/* get activities of the input for a sub-logframe */</span>
            <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; iaMap = </span><span class="s0">new </span><span class="s1">HashMap&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowIA : IASheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowIA.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">inputID = (</span><span class="s0">int</span><span class="s1">) rowIA.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == inputID) {</span>
                    <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; activitySet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
                    <span class="s0">long </span><span class="s1">parentID = (</span><span class="s0">int</span><span class="s1">) rowIA.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">childID = (</span><span class="s0">int</span><span class="s1">) rowIA.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">activityID = (</span><span class="s0">int</span><span class="s1">) rowIA.getCell(</span><span class="s4">3</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">activitySet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(inputID, activityID));</span>
                    <span class="s1">iaMap.put(activitySet, </span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(parentID, childID));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">/* human input */</span>
            <span class="s0">long </span><span class="s1">humanID = -</span><span class="s4">1</span><span class="s1">;</span>
            <span class="s0">int </span><span class="s1">humanQuantity = </span><span class="s4">0</span><span class="s1">;</span>

            <span class="s2">/* human set input */</span>
            <span class="s1">Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuMap = </span><span class="s0">new </span><span class="s1">HashMap&lt;&gt;();</span>
            <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; huSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>

            <span class="s2">/* material input */</span>
            <span class="s0">long </span><span class="s1">materialID = -</span><span class="s4">1</span><span class="s1">;</span>
            <span class="s0">int </span><span class="s1">materialQuantity = </span><span class="s4">0</span><span class="s1">;</span>

            <span class="s2">/* expense inputs */</span>
            <span class="s0">int </span><span class="s1">expenseID = -</span><span class="s4">1</span><span class="s1">;</span>
            <span class="s0">double </span><span class="s1">expense = </span><span class="s4">0.0</span><span class="s1">;</span>

            <span class="s2">/* income inputs */</span>
            <span class="s0">long </span><span class="s1">incomeID = -</span><span class="s4">1</span><span class="s1">, funderID = -</span><span class="s4">1</span><span class="s1">;</span>
            <span class="s0">double </span><span class="s1">fund = </span><span class="s4">0.0</span><span class="s1">;</span>

            <span class="s0">for </span><span class="s1">(Row rowHuman : humanSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowHuman.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s1">humanID = (</span><span class="s0">int</span><span class="s1">) rowHuman.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == humanID) {</span>
                    <span class="s1">humanQuantity = (</span><span class="s0">int</span><span class="s1">) rowHuman.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>

                    <span class="s2">/* human set input */</span>
                    <span class="s0">long </span><span class="s1">humanSetInputID = -</span><span class="s4">1</span><span class="s1">, humanSetID = -</span><span class="s4">1</span><span class="s1">, userID = -</span><span class="s4">1</span><span class="s1">;</span>

                    <span class="s0">for </span><span class="s1">(Row rowHumanSet : humanSetSheet) {</span>
                        <span class="s2">//just skip the row if row number is 0</span>
                        <span class="s0">if </span><span class="s1">(rowHumanSet.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                            <span class="s0">continue</span><span class="s1">;</span>
                        <span class="s1">}</span>

                        <span class="s1">humanSetInputID = (</span><span class="s0">int</span><span class="s1">) rowHumanSet.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                                <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                        <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == humanSetInputID) {</span>
                            <span class="s1">humanSetID = (</span><span class="s0">int</span><span class="s1">) rowHumanSet.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                            <span class="s1">userID = (</span><span class="s0">int</span><span class="s1">) rowHumanSet.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                            <span class="s1">huSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(humanSetID, userID));</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>

                    <span class="s0">break</span><span class="s1">;</span>
                <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">humanID = -</span><span class="s4">1</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s1">hiuMap.put(componentModel.getComponentID(), huSet);</span>

            <span class="s2">/* material input */</span>
            <span class="s0">for </span><span class="s1">(Row rowMaterial : materialSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowMaterial.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s1">materialID = (</span><span class="s0">int</span><span class="s1">) rowMaterial.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == materialID) {</span>
                    <span class="s1">materialQuantity = (</span><span class="s0">int</span><span class="s1">) rowMaterial.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">break</span><span class="s1">;</span>
                <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">materialID = -</span><span class="s4">1</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">/* income input */</span>
            <span class="s1">Map&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaMap = </span><span class="s0">new </span><span class="s1">HashMap&lt;&gt;();</span>
            <span class="s1">Set&lt;Pair&lt;Long, Double&gt;&gt; fundSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">long </span><span class="s1">fundInputID, fundID = -</span><span class="s4">1</span><span class="s1">;</span>
            <span class="s0">double </span><span class="s1">amount;</span>
            <span class="s0">for </span><span class="s1">(Row rowIncome : incomeSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowIncome.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s1">incomeID = (</span><span class="s0">int</span><span class="s1">) rowIncome.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>

                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == incomeID) {</span>

                    <span class="s0">for </span><span class="s1">(Row rowFundSet : fundSheet) {</span>
                        <span class="s2">//just skip the row if row number is 0</span>
                        <span class="s0">if </span><span class="s1">(rowFundSet.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                            <span class="s0">continue</span><span class="s1">;</span>
                        <span class="s1">}</span>

                        <span class="s1">fundInputID = (</span><span class="s0">int</span><span class="s1">) rowFundSet.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                                <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                        <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == fundInputID) {</span>
                            <span class="s1">fundID = (</span><span class="s0">int</span><span class="s1">) rowFundSet.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                            <span class="s1">funderID = (</span><span class="s0">int</span><span class="s1">) rowFundSet.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                            <span class="s1">fund = (</span><span class="s0">double</span><span class="s1">) rowFundSet.getCell(</span><span class="s4">3</span><span class="s1">,</span>
                                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>

                            <span class="s1">fundSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;Long, Double&gt;((</span><span class="s0">long</span><span class="s1">) funderID, fund));</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                    <span class="s1">ffaMap.put(fundID, fundSet);</span>

                    <span class="s0">break</span><span class="s1">;</span>
                <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">incomeID = -</span><span class="s4">1</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">/* expense input */</span>
            <span class="s0">for </span><span class="s1">(Row rowExpense : expenseSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowExpense.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s1">expenseID = (</span><span class="s0">int</span><span class="s1">) rowExpense.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(componentModel.getComponentID() == expenseID) {</span>
                    <span class="s1">expense = (</span><span class="s0">int</span><span class="s1">) rowExpense.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">break</span><span class="s1">;</span>
                <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
                    <span class="s1">expenseID = -</span><span class="s4">1</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s0">if </span><span class="s1">(!addComponents(componentModel, impactModelSet,</span>
                    <span class="s1">outcomeModelSet, outputModelSet, activityModelSet, inputModelSet,</span>
                    <span class="s1">oiMap, ooMap, aoMap, iaMap, precedingSet, assignmentMap,</span>
                    <span class="s1">humanID, humanQuantity, hiuMap, materialID, materialQuantity, incomeID, ffaMap,</span>
                    <span class="s1">expenseID, expense)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">private boolean </span><span class="s1">addComponents(cComponentModel componentModel,</span>
                                  <span class="s1">Set&lt;cImpactModel&gt; impactModelSet,</span>
                                  <span class="s1">Set&lt;cOutcomeModel&gt; outcomeModelSet,</span>
                                  <span class="s1">Set&lt;cOutputModel&gt; outputModelSet,</span>
                                  <span class="s1">Set&lt;cActivityModel&gt; activityModelSet,</span>
                                  <span class="s1">Set&lt;cInputModel&gt; inputModelSet,</span>
                                  <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; oiMap,</span>
                                  <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; ooMap,</span>
                                  <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; aoMap,</span>
                                  <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; iaMap,</span>
                                  <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; precedingSet,</span>
                                  <span class="s1">Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; assignmentMap,</span>
                                  <span class="s0">long </span><span class="s1">humanID, </span><span class="s0">int </span><span class="s1">humanQuantity,</span>
                                  <span class="s1">Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuMap,</span>
                                  <span class="s0">long </span><span class="s1">materialID, </span><span class="s0">int </span><span class="s1">materialQuantity,</span>
                                  <span class="s0">long </span><span class="s1">incomeID, Map&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaMap,</span>
                                  <span class="s0">long </span><span class="s1">expenseID, </span><span class="s0">double </span><span class="s1">expense) {</span>

        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, componentModel.getComponentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_LOGFRAME_FK_ID, componentModel.getLogFrameModel().getLogFrameID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_NAME, componentModel.getName());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DESCRIPTION, componentModel.getDescription());</span>

        <span class="s2">// insert details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblCOMPONENT, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// impact</span>
            <span class="s0">for </span><span class="s1">(cImpactModel impactModel : impactModelSet) {</span>
                <span class="s0">if </span><span class="s1">(!addImpact(impactModel)) {</span>
                    <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">// outcome</span>
            <span class="s0">for </span><span class="s1">(cOutcomeModel outcomeModel : outcomeModelSet) {</span>
                <span class="s0">if </span><span class="s1">(!addOutcome(outcomeModel, oiMap)) {</span>
                    <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">// output</span>
            <span class="s0">for </span><span class="s1">(cOutputModel outputModel : outputModelSet) {</span>
                <span class="s0">if </span><span class="s1">(!addOutput(outputModel, ooMap)) {</span>
                    <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">// activity</span>
            <span class="s0">for </span><span class="s1">(cActivityModel activityModel : activityModelSet) {</span>
                <span class="s0">if </span><span class="s1">(!addActivity(activityModel, aoMap, precedingSet, assignmentMap)) {</span>
                    <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">// input</span>
            <span class="s0">for </span><span class="s1">(cInputModel inputModel : inputModelSet) {</span>
                <span class="s0">if </span><span class="s1">(!addInput(inputModel, iaMap, humanID, humanQuantity, hiuMap,</span>
                        <span class="s1">materialID, materialQuantity, incomeID, ffaMap, expenseID, expense)) {</span>
                    <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing COMPACT from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteComponents() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblCOMPONENT, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">addImpact(cImpactModel impactModel) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_COMPONENT_FK_ID, impactModel.getComponentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, impactModel.getParentID());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblIMPACT, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add impact, question and criteria tuple</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing IMPACT from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteImpacts() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblIMPACT, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">addOutcome(cOutcomeModel outcomeModel,</span>
                              <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; oiMap) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_COMPONENT_FK_ID, outcomeModel.getComponentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, outcomeModel.getParentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_IMPACT_FK_ID, outcomeModel.getImpactModel().getComponentID());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblOUTCOME, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add sub-logFrame, outcome and impact tuple</span>
            <span class="s0">for </span><span class="s1">(Map.Entry&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; soiEntry : oiMap.entrySet()) {</span>
                <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; oiPair : soiEntry.getKey()) {</span>
                    <span class="s0">long </span><span class="s1">outcomeID = oiPair.first;</span>
                    <span class="s0">long </span><span class="s1">impactID = oiPair.second;</span>

                    <span class="s1">Pair&lt;Long, Long&gt; sPair = soiEntry.getValue();</span>
                    <span class="s0">long </span><span class="s1">parentID = sPair.first;</span>
                    <span class="s0">long </span><span class="s1">childID = sPair.second;</span>

                    <span class="s0">if </span><span class="s1">(!addOutcomeImpact(parentID, childID, outcomeID, impactID))</span>
                        <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>


        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing OUTCOME from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">parentID  parent identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">childID   child identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">outcomeID outcome identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">impactID  impact identification</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addOutcomeImpact(</span><span class="s0">long </span><span class="s1">parentID, </span><span class="s0">long </span><span class="s1">childID, </span><span class="s0">long </span><span class="s1">outcomeID, </span><span class="s0">long </span><span class="s1">impactID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, parentID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_CHILD_FK_ID, childID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_OUTCOME_FK_ID, outcomeID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_IMPACT_FK_ID, impactID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblOUTCOME_IMPACT, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteOutcomes() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblOUTCOME, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteOutcomeImpacts() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblOUTCOME_IMPACT, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">addOutput(cOutputModel outputModel,</span>
                             <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; ooMap) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_COMPONENT_FK_ID, outputModel.getComponentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, outputModel.getParentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_OUTCOME_FK_ID, outputModel.getOutcomeModel().getComponentID());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblOUTPUT, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add sub-logFrame, outcome and impact tuple</span>
            <span class="s0">for </span><span class="s1">(Map.Entry&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; sooEntry :</span>
                    <span class="s1">ooMap.entrySet()) {</span>
                <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; ooPair : sooEntry.getKey()) {</span>
                    <span class="s0">long </span><span class="s1">outputID = ooPair.first;</span>
                    <span class="s0">long </span><span class="s1">outcomeID = ooPair.second;</span>

                    <span class="s1">Pair&lt;Long, Long&gt; sPair = sooEntry.getValue();</span>
                    <span class="s0">long </span><span class="s1">parentID = sPair.first;</span>
                    <span class="s0">long </span><span class="s1">childID = sPair.second;</span>

                    <span class="s0">if </span><span class="s1">(!addOutputOutcome(parentID, childID, outputID, outcomeID))</span>
                        <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing OUTPUT from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">parentID  parent identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">childID   child identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">outputID  output identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">outcomeID outcome identification</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addOutputOutcome(</span><span class="s0">long </span><span class="s1">parentID, </span><span class="s0">long </span><span class="s1">childID, </span><span class="s0">long </span><span class="s1">outputID, </span><span class="s0">long </span><span class="s1">outcomeID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, parentID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_CHILD_FK_ID, childID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_OUTPUT_FK_ID, outputID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_OUTCOME_FK_ID, outcomeID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblOUTPUT_OUTCOME, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteOutputs() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblOUTPUT, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteOutputOutcomes() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblOUTPUT_OUTCOME, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">addActivity(cActivityModel activityModel,</span>
                               <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; aoMap,</span>
                               <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; precedingSet,</span>
                               <span class="s1">Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; assignmentMap) {</span>

        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_COMPONENT_FK_ID, activityModel.getComponentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, activityModel.getParentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_OUTPUT_FK_ID, activityModel.getOutputModel().getComponentID());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblACTIVITY, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add preceding activity</span>
            <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; pair : precedingSet) {</span>
                <span class="s0">long </span><span class="s1">succeedingID = pair.first;</span>
                <span class="s0">long </span><span class="s1">precedingID = pair.second;</span>
                <span class="s0">if </span><span class="s1">(!addPrecedingActivity(succeedingID, precedingID))</span>
                    <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add assignment, staff and activity tuple</span>
            <span class="s0">for </span><span class="s1">(Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; asaEntry : assignmentMap.entrySet()) {</span>
                <span class="s0">long </span><span class="s1">activityID = asaEntry.getKey();</span>
                <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; saPair : asaEntry.getValue()) {</span>
                    <span class="s0">long </span><span class="s1">assignmentID = saPair.first;</span>
                    <span class="s0">long </span><span class="s1">staffID = saPair.second;</span>

                    <span class="s0">if </span><span class="s1">(!addActivityAssignment(assignmentID, staffID, activityID))</span>
                        <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">// add sub-logFrame, activity and output tuple</span>
            <span class="s0">for </span><span class="s1">(Map.Entry&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; saoEntry : aoMap.entrySet()) {</span>
                <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; aoPair : saoEntry.getKey()) {</span>
                    <span class="s0">long </span><span class="s1">activityID = aoPair.first;</span>
                    <span class="s0">long </span><span class="s1">outputID = aoPair.second;</span>

                    <span class="s1">Pair&lt;Long, Long&gt; sPair = saoEntry.getValue();</span>
                    <span class="s0">long </span><span class="s1">parentID = sPair.first;</span>
                    <span class="s0">long </span><span class="s1">childID = sPair.second;</span>

                    <span class="s0">if </span><span class="s1">(!addActivityOutput(parentID, childID, activityID, outputID))</span>
                        <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing ACTIVITY from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>
        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">activityID  activity identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">precedingID preceding identification</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addPrecedingActivity(</span><span class="s0">long </span><span class="s1">activityID, </span><span class="s0">long </span><span class="s1">precedingID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_ACTIVITY_FK_ID, activityID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_PRECEDING_ACTIVITY_FK_ID, precedingID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblPRECEDINGACTIVITY, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">assignmentID assignment identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">staffID      staff identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">activityID   activity identification</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addActivityAssignment(</span><span class="s0">long </span><span class="s1">assignmentID, </span><span class="s0">long </span><span class="s1">staffID, </span><span class="s0">long </span><span class="s1">activityID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, assignmentID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_STAFF_FK_ID, staffID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ACTIVITY_FK_ID, activityID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblACTIVITYASSIGNMENT, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">parentID   parent identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">childID    child identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">activityID activity identification</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">outputID   output identification</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addActivityOutput(</span><span class="s0">long </span><span class="s1">parentID, </span><span class="s0">long </span><span class="s1">childID, </span><span class="s0">long </span><span class="s1">activityID, </span><span class="s0">long </span><span class="s1">outputID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, parentID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_CHILD_FK_ID, childID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ACTIVITY_FK_ID, activityID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_OUTPUT_FK_ID, outputID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblACTIVITY_OUTPUT, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deletePrecedingActivities() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblPRECEDINGACTIVITY, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteActivityAssignments() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblACTIVITYASSIGNMENT, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteActivityOutputs() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblACTIVITY_OUTPUT, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">deleteActivities() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblACTIVITY, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">addInput(cInputModel inputModel,</span>
                            <span class="s1">Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; iaMap,</span>
                            <span class="s0">long </span><span class="s1">humanID, </span><span class="s0">int </span><span class="s1">humanQuantity,</span>
                            <span class="s1">Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuMap,</span>
                            <span class="s0">long </span><span class="s1">materialID, </span><span class="s0">int </span><span class="s1">materialQuantity,</span>
                            <span class="s0">long </span><span class="s1">incomeID, Map&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaMap,</span>
                            <span class="s0">long </span><span class="s1">expenseID, </span><span class="s0">double </span><span class="s1">expense) {</span>

        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_COMPONENT_FK_ID, inputModel.getComponentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ACTIVITY_FK_ID, inputModel.getActivityModel().getComponentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_RESOURCE_TYPE_FK_ID,</span>
                <span class="s1">inputModel.getResourceTypeModel().getResourceTypeID());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblINPUT, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add sub-logFrame, activity and output tuple</span>
            <span class="s0">for </span><span class="s1">(Map.Entry&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; siaEntry : iaMap.entrySet()) {</span>
                <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; iaPair : siaEntry.getKey()) {</span>
                    <span class="s0">long </span><span class="s1">inputID = iaPair.first;</span>
                    <span class="s0">long </span><span class="s1">activityID = iaPair.second;</span>

                    <span class="s1">Pair&lt;Long, Long&gt; sPair = siaEntry.getValue();</span>
                    <span class="s0">long </span><span class="s1">parentID = sPair.first;</span>
                    <span class="s0">long </span><span class="s1">childID = sPair.second;</span>

                    <span class="s0">if </span><span class="s1">(!addInputActivity(parentID, childID, inputID, activityID))</span>
                        <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s0">if </span><span class="s1">(humanID != -</span><span class="s4">1</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">addHumanInput(inputModel.getComponentID(), humanQuantity, hiuMap);</span>
            <span class="s1">}</span>

            <span class="s0">if </span><span class="s1">(materialID != -</span><span class="s4">1</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">addMaterialInput(inputModel.getComponentID(), materialQuantity);</span>
            <span class="s1">}</span>

            <span class="s0">if </span><span class="s1">(incomeID != -</span><span class="s4">1</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">addIncomeInput(inputModel.getComponentID(), ffaMap);</span>
            <span class="s1">}</span>

            <span class="s0">if </span><span class="s1">(expenseID != -</span><span class="s4">1</span><span class="s1">) {</span>
                <span class="s0">return </span><span class="s1">addExpenseInput(inputModel.getComponentID(), expense);</span>
            <span class="s1">}</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing INPUT from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">private boolean </span><span class="s1">addInputActivity(</span><span class="s0">long </span><span class="s1">parentID, </span><span class="s0">long </span><span class="s1">childID, </span><span class="s0">long </span><span class="s1">inputID, </span><span class="s0">long </span><span class="s1">activityID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, parentID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_CHILD_FK_ID, childID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ACTIVITY_FK_ID, activityID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblINPUT_ACTIVITY, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">private boolean </span><span class="s1">addHumanInput(</span><span class="s0">long </span><span class="s1">inputID, </span><span class="s0">int </span><span class="s1">humanQuantity, Map&lt;Long,</span>
            <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuMap) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_QUANTITY, humanQuantity);</span>

        <span class="s2">// insert evaluation type details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblHUMAN, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add activity, question and criteria tuple</span>
            <span class="s0">for </span><span class="s1">(Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuEntry : hiuMap.entrySet()) {</span>
                <span class="s0">long </span><span class="s1">hsInputID = hiuEntry.getKey();</span>
                <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; huPair : hiuEntry.getValue()) {</span>
                    <span class="s0">long </span><span class="s1">humanSetID = huPair.first;</span>
                    <span class="s0">long </span><span class="s1">userID = huPair.second;</span>

                    <span class="s0">if </span><span class="s1">(!addHumanSet(humanSetID, hsInputID, userID))</span>
                        <span class="s0">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing HUMAN INPUT from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">private boolean </span><span class="s1">addHumanSet(</span><span class="s0">long </span><span class="s1">humanSetID, </span><span class="s0">long </span><span class="s1">hsInputID, </span><span class="s0">long </span><span class="s1">userID) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, humanSetID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, hsInputID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_USER_FK_ID, userID);</span>

        <span class="s2">// insert evaluation type details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblHUMANSET, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing HUMAN SET from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">private boolean </span><span class="s1">addMaterialInput(</span><span class="s0">long </span><span class="s1">inputID, </span><span class="s0">int </span><span class="s1">materialQuantity) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_QUANTITY, materialQuantity);</span>

        <span class="s2">// insert evaluation type details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblMATERIAL, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing MATERIAL INPUT from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">private boolean </span><span class="s1">addIncomeInput(</span><span class="s0">long </span><span class="s1">inputID, Map&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaMap) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
        <span class="s2">//cv.put(cSQLDBHelper.KEY_FUNDER_FK_ID, funderID);</span>
        <span class="s2">//cv.put(cSQLDBHelper.KEY_INCOME, income);</span>
        <span class="s2">// insert evaluation type details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblINCOME, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add fundID, inputID, funderID and amount/fund tuple</span>
            <span class="s1">Gson gson = </span><span class="s0">new </span><span class="s1">Gson();</span>
            <span class="s0">for </span><span class="s1">(Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaEntry : ffaMap.entrySet()) {</span>
                <span class="s0">long </span><span class="s1">fundID = ffaEntry.getKey();</span>
                <span class="s0">for </span><span class="s1">(Pair&lt;Long, Double&gt; ifPair : ffaEntry.getValue()) {</span>
                    <span class="s0">long </span><span class="s1">funderID = ifPair.first;</span>
                    <span class="s0">double </span><span class="s1">fund = ifPair.second;</span>
                    <span class="s0">if </span><span class="s1">(!addFund(fundID, inputID, funderID, fund)) {</span>
                        <span class="s0">return false</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing INCOME INPUT from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">private boolean </span><span class="s1">addFund(</span><span class="s0">long </span><span class="s1">fundID, </span><span class="s0">long </span><span class="s1">inputID, </span><span class="s0">long </span><span class="s1">funderID, </span><span class="s0">double </span><span class="s1">fund) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, fundID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_FUNDER_FK_ID, funderID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_FUND, fund);</span>

        <span class="s2">// insert evaluation type details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblFUND, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing FUND from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">private boolean </span><span class="s1">addExpenseInput(</span><span class="s0">long </span><span class="s1">inputID, </span><span class="s0">double </span><span class="s1">amount) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_EXPENSE, amount);</span>

        <span class="s2">// insert evaluation type details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblEXPENSE, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing EXPENSE INPUT from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteInputActivities() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblINPUT_ACTIVITY, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteHumans() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblHUMAN, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteHumanSets() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblHUMANSET, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteMaterials() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblMATERIAL, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteIncomes() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblINCOME, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteFunds() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblFUND, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteExpenses() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblEXPENSE, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteInputs() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblINPUT, </span><span class="s0">null</span><span class="s1">, </span><span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/* ############################## EVALUATION CRITERIA FUNCTIONS ##############################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts criteria data from excel and adds it to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addCriteriaFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Sheet ECSheet = workbook.getSheet(cExcelHelper.SHEET_tblCRITERIA);</span>

        <span class="s0">if </span><span class="s1">(ECSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row cRow : ECSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(cRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cCriteriaModel criteriaModel = </span><span class="s0">new </span><span class="s1">cCriteriaModel();</span>

            <span class="s1">criteriaModel.setCriteriaID((</span><span class="s0">int</span><span class="s1">)</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">0</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">criteriaModel.setName(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">1</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">criteriaModel.setDescription(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">2</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>

            <span class="s0">if </span><span class="s1">(!addCriteria(criteriaModel)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds criteria data to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">criteriaModel criteria model</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addCriteria(cCriteriaModel criteriaModel) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, criteriaModel.getCriteriaID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_NAME, criteriaModel.getName());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DESCRIPTION, criteriaModel.getDescription());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblCRITERIA, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing EVALUATION CRITERIA from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteCriteria() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblCRITERIA, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/*################################ QUESTION GROUPING FUNCTIONS ###############################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts question grouping data from excel and adds it to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addQuestionGroupingFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Sheet QGSheet = workbook.getSheet(cExcelHelper.SHEET_tblQUESTIONGROUPING);</span>

        <span class="s0">if </span><span class="s1">(QGSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row cRow : QGSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(cRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cQuestionGroupingModel questionGroupingModel = </span><span class="s0">new </span><span class="s1">cQuestionGroupingModel();</span>

            <span class="s1">questionGroupingModel.setQuestionGroupingID(</span>
                    <span class="s1">(</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">0</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionGroupingModel.setLabel((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionGroupingModel.setName(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">2</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">questionGroupingModel.setDescription(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">3</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>

            <span class="s0">if </span><span class="s1">(!addQuestionGroupingFromExcel(questionGroupingModel)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds question grouping data to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">questionGroupingModel question grouping model</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addQuestionGroupingFromExcel(cQuestionGroupingModel questionGroupingModel) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, questionGroupingModel.getQuestionGroupingID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_LABEL, questionGroupingModel.getLabel());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_NAME, questionGroupingModel.getName());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DESCRIPTION, questionGroupingModel.getDescription());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblQUESTIONGROUPING, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing QUESTION GROUPING from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteQuestionGroupings() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblQUESTIONGROUPING, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/* ################################## QUESTION TYPE FUNCTIONS ################################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts question type data from excel and adds it to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addQuestionTypeFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Sheet QTSheet = workbook.getSheet(cExcelHelper.SHEET_tblQUESTIONTYPE);</span>

        <span class="s0">if </span><span class="s1">(QTSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row cRow : QTSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(cRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cQuestionTypeModel questionTypeModel = </span><span class="s0">new </span><span class="s1">cQuestionTypeModel();</span>

            <span class="s1">questionTypeModel.setQuestionTypeID(</span>
                    <span class="s1">(</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">0</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionTypeModel.setName(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">1</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">questionTypeModel.setDescription(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">2</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>

            <span class="s0">if </span><span class="s1">(!addQuestionType(questionTypeModel)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds question grouping data to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">questionTypeModel question grouping model</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addQuestionType(cQuestionTypeModel questionTypeModel) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, questionTypeModel.getQuestionTypeID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_NAME, questionTypeModel.getName());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DESCRIPTION, questionTypeModel.getDescription());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblQUESTIONTYPE, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing QUESTION TYPE from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteQuestionTypes() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblQUESTIONTYPE, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/* #################################### QUESTION FUNCTIONS ###################################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts question data from excel and adds it to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addQuestionFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Sheet QSheet = workbook.getSheet(cExcelHelper.SHEET_tblQUESTION);</span>
        <span class="s1">Sheet PQSheet = workbook.getSheet(cExcelHelper.SHEET_tblPRIMITIVEQUESTION);</span>
        <span class="s1">Sheet AQSheet = workbook.getSheet(cExcelHelper.SHEET_tblARRAYQUESTION);</span>
        <span class="s1">Sheet MQSheet = workbook.getSheet(cExcelHelper.SHEET_tblMATRIXQUESTION);</span>
        <span class="s1">Sheet QCSheet = workbook.getSheet(cExcelHelper.SHEET_tblQUESTION_CRITERIA);</span>

        <span class="s0">if </span><span class="s1">(QSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row rowQ : QSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(rowQ.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cQuestionModel questionModel = </span><span class="s0">new </span><span class="s1">cQuestionModel();</span>

            <span class="s1">questionModel.setQuestionID((</span><span class="s0">int</span><span class="s1">) rowQ.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionModel.getLogFrameModel().setLogFrameID((</span><span class="s0">int</span><span class="s1">) rowQ.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionModel.getComponentModel().setComponentID((</span><span class="s0">int</span><span class="s1">) rowQ.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionModel.getQuestionTypeModel().setQuestionTypeID((</span><span class="s0">int</span><span class="s1">) rowQ.getCell(</span><span class="s4">3</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionModel.getQuestionGroupingModel().setQuestionGroupingID((</span><span class="s0">int</span><span class="s1">) rowQ.getCell(</span><span class="s4">4</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionModel.setLabel((</span><span class="s0">int</span><span class="s1">) rowQ.getCell(</span><span class="s4">5</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">questionModel.setQuestion(rowQ.getCell(</span><span class="s4">6</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">questionModel.setDefaultChart((</span><span class="s0">int</span><span class="s1">) rowQ.getCell(</span><span class="s4">7</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>

            <span class="s2">/* get primitive question */</span>
            <span class="s1">Set&lt;Long&gt; primitiveChartIDs = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>

            <span class="s0">for </span><span class="s1">(Row rowPQ : PQSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowPQ.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">questionID = (</span><span class="s0">int</span><span class="s1">) rowPQ.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(questionModel.getQuestionID() == questionID) {</span>
                    <span class="s1">primitiveChartIDs.add((</span><span class="s0">long</span><span class="s1">) rowPQ.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">/* get array question */</span>
            <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; arrayChartIDs = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowAQ : AQSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowAQ.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">questionID = (</span><span class="s0">long</span><span class="s1">) rowAQ.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(questionModel.getQuestionID() == questionID) {</span>
                    <span class="s0">long </span><span class="s1">arraySet = (</span><span class="s0">long</span><span class="s1">) rowAQ.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">arrayChart = (</span><span class="s0">long</span><span class="s1">) rowAQ.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">arrayChartIDs.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(arraySet, arrayChart));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s2">/* get matrix question */</span>
            <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; matrixChartIDs = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowMQ : MQSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowMQ.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">questionID = (</span><span class="s0">long</span><span class="s1">) rowMQ.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(questionModel.getQuestionID() == questionID) {</span>
                    <span class="s0">long </span><span class="s1">matrixSet = (</span><span class="s0">long</span><span class="s1">) rowMQ.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s0">long </span><span class="s1">matrixChart = (</span><span class="s0">long</span><span class="s1">) rowMQ.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">matrixChartIDs.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(matrixSet, matrixChart));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>


            <span class="s2">/* get question criteria */</span>
            <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; qcSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowQC : QCSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowQC.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">questionID = (</span><span class="s0">int</span><span class="s1">) rowQC.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(questionModel.getQuestionID() == questionID) {</span>
                    <span class="s0">long </span><span class="s1">criteriaID = (</span><span class="s0">int</span><span class="s1">) rowQC.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">qcSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(questionID, criteriaID));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s0">if </span><span class="s1">(!addQuestion(questionModel, primitiveChartIDs, arrayChartIDs,</span>
                    <span class="s1">matrixChartIDs, qcSet)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds question data to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">questionModel question model</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">qcSet</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addQuestion(cQuestionModel questionModel,</span>
                               <span class="s1">Set&lt;Long&gt; primitiveChartIDs,</span>
                               <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; arrayChartIDs,</span>
                               <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; matrixChartIDs,</span>
                               <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; qcSet) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, questionModel.getQuestionID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_LOGFRAME_FK_ID, questionModel.getLogFrameModel().getLogFrameID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_COMPONENT_FK_ID, questionModel.getComponentModel().getComponentID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_QUESTION_TYPE_FK_ID,</span>
                <span class="s1">questionModel.getQuestionTypeModel().getQuestionTypeID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_QUESTION_GROUPING_FK_ID,</span>
                <span class="s1">questionModel.getQuestionGroupingModel().getQuestionGroupingID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_LABEL, questionModel.getLabel());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_QUESTION, questionModel.getQuestion());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DEFAULT_CHART, questionModel.getDefaultChart());</span>

        <span class="s0">try </span><span class="s1">{</span>
            <span class="s2">/* insert question details */</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblQUESTION, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s0">for </span><span class="s1">(</span><span class="s0">long </span><span class="s1">chartID : primitiveChartIDs) {</span>
                <span class="s0">if </span><span class="s1">(!addPrimitiveQuestion(questionModel.getQuestionID(), chartID))</span>
                    <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; arrayQuestion : arrayChartIDs) {</span>
                <span class="s0">if </span><span class="s1">(!addArrayQuestion(questionModel.getQuestionID(), arrayQuestion.first,</span>
                        <span class="s1">arrayQuestion.second))</span>
                    <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; matrixQuestion : matrixChartIDs) {</span>
                <span class="s0">if </span><span class="s1">(!addMatrixQuestion(questionModel.getQuestionID(), matrixQuestion.first,</span>
                        <span class="s1">matrixQuestion.second))</span>
                    <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add question criteria</span>
            <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; pair : qcSet) {</span>
                <span class="s0">if </span><span class="s1">(!addQuestionCriteria(pair.first, pair.second))</span>
                    <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing QUESTION from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">addPrimitiveQuestion(</span><span class="s0">long </span><span class="s1">questionID, </span><span class="s0">long </span><span class="s1">primitiveChartID) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_PRIMITIVE_CHART_FK_ID, primitiveChartID);</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblPRIMITIVEQUESTION, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing PRIMITIVE QUESTION from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">addArrayQuestion(</span><span class="s0">long </span><span class="s1">questionID, </span><span class="s0">long </span><span class="s1">arraySetID, </span><span class="s0">long </span><span class="s1">arrayChartID) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ARRAY_SET_FK_ID, arraySetID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ARRAY_CHART_FK_ID, arrayChartID);</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblARRAYQUESTION, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing ARRAY QUESTION from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">addMatrixQuestion(</span><span class="s0">long </span><span class="s1">questionID, </span><span class="s0">long </span><span class="s1">matrixSetID, </span><span class="s0">long </span><span class="s1">matrixChartID) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_MATRIX_SET_FK_ID, matrixSetID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_MATRIX_CHART_FK_ID, matrixChartID);</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblMATRIXQUESTION, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing MATRIX QUESTION from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s0">public boolean </span><span class="s1">addQuestionCriteria(</span><span class="s0">long </span><span class="s1">questionID, </span><span class="s0">long </span><span class="s1">criteriaID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_CRITERIA_FK_ID, criteriaID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblQUESTION_CRITERIA, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteQuestions() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblQUESTION, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deletePrimitiveQuestions() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblPRIMITIVEQUESTION, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteArrayQuestions() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblARRAYQUESTION, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteMatrixQuestions() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblMATRIXQUESTION, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteQuestionCriteria() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblQUESTION_CRITERIA, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/* ################################## RAID CATEGORY FUNCTIONS ################################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts RAID category data from excel and adds it to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addRaidCategoryFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Sheet QTSheet = workbook.getSheet(cExcelHelper.SHEET_tblRAIDCATEGORY);</span>

        <span class="s0">if </span><span class="s1">(QTSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row cRow : QTSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(cRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cRaidCategoryModel raidCategoryModel = </span><span class="s0">new </span><span class="s1">cRaidCategoryModel();</span>

            <span class="s1">raidCategoryModel.setRaidCategoryID(</span>
                    <span class="s1">(</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">0</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidCategoryModel.setName(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">1</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">raidCategoryModel.setDescription(</span>
                    <span class="s1">cRow.getCell(</span><span class="s4">2</span><span class="s1">, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>

            <span class="s0">if </span><span class="s1">(!addRaidCategory(raidCategoryModel)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds raid category data to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">raidCategoryModel raid category model</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addRaidCategory(cRaidCategoryModel raidCategoryModel) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, raidCategoryModel.getRaidCategoryID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_NAME, raidCategoryModel.getName());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DESCRIPTION, raidCategoryModel.getDescription());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblRAIDCATEGORY, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing RAID CATEGORY from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteRaidCategories() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblRAIDCATEGORY, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>


    <span class="s2">/* ##################################### RAID FUNCTIONS ######################################*/</span>

    <span class="s2">/**</span>
     <span class="s2">* This function extracts raid data from excel and adds it to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">addRaidFromExcel() {</span>
        <span class="s1">Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
        <span class="s1">Sheet RSheet = workbook.getSheet(cExcelHelper.SHEET_tblRAID);</span>
        <span class="s1">Sheet CRSheet = workbook.getSheet(cExcelHelper.SHEET_tblCOMPONENT_RAID);</span>

        <span class="s0">if </span><span class="s1">(RSheet == </span><span class="s0">null</span><span class="s1">) {</span>
            <span class="s0">return false</span><span class="s1">;</span>
        <span class="s1">}</span>

        <span class="s0">for </span><span class="s1">(Row cRow : RSheet) {</span>
            <span class="s2">//just skip the row if row number is 0</span>
            <span class="s0">if </span><span class="s1">(cRow.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">continue</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s1">cRaidModel raidModel = </span><span class="s0">new </span><span class="s1">cRaidModel();</span>

            <span class="s1">raidModel.setRaidID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.getLogFrameModel().setLogFrameID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.getRaidCategoryModel().setRaidCategoryID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">2</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.getOriginatorModel().setHumanSetID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">3</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.getOwnerModel().setHumanSetID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">4</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.getFrequencyModel().setFrequencyID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">5</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.getRaidLikelihoodModel().setRaidLikelihoodID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">6</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.getRaidImpactModel().setRaidImpactID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">7</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.getRobotModel().setRobotID((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">8</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.setScore((</span><span class="s0">int</span><span class="s1">) cRow.getCell(</span><span class="s4">9</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
            <span class="s1">raidModel.setName(cRow.getCell(</span><span class="s4">10</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
            <span class="s1">raidModel.setDescription(cRow.getCell(</span><span class="s4">11</span><span class="s1">,</span>
                    <span class="s1">Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>

            <span class="s2">/* get raids of the outcome */</span>
            <span class="s1">Set&lt;Pair&lt;Long, Long&gt;&gt; crSet = </span><span class="s0">new </span><span class="s1">HashSet&lt;&gt;();</span>
            <span class="s0">for </span><span class="s1">(Row rowCR : CRSheet) {</span>
                <span class="s2">//just skip the row if row number is 0</span>
                <span class="s0">if </span><span class="s1">(rowCR.getRowNum() == </span><span class="s4">0</span><span class="s1">) {</span>
                    <span class="s0">continue</span><span class="s1">;</span>
                <span class="s1">}</span>

                <span class="s0">long </span><span class="s1">raidID = (</span><span class="s0">int</span><span class="s1">) rowCR.getCell(</span><span class="s4">1</span><span class="s1">,</span>
                        <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                <span class="s0">if </span><span class="s1">(raidModel.getRaidID() == raidID) {</span>
                    <span class="s0">long </span><span class="s1">componentID = (</span><span class="s0">int</span><span class="s1">) rowCR.getCell(</span><span class="s4">0</span><span class="s1">,</span>
                            <span class="s1">Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
                    <span class="s1">crSet.add(</span><span class="s0">new </span><span class="s1">Pair&lt;&gt;(componentID, raidID));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>

            <span class="s0">if </span><span class="s1">(!addRaid(raidModel, crSet)) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>

    <span class="s2">/**</span>
     <span class="s2">* This function adds raid data to the database.</span>
     <span class="s2">*</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">raidModel raid model</span>
     <span class="s2">* </span><span class="s3">@param </span><span class="s2">crSet</span>
     <span class="s2">* </span><span class="s3">@return </span><span class="s2">boolean</span>
     <span class="s2">*/</span>
    <span class="s0">public boolean </span><span class="s1">addRaid(cRaidModel raidModel, Set&lt;Pair&lt;Long, Long&gt;&gt; crSet) {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// create content object for storing data</span>
        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s2">// assign values to the table fields</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ID, raidModel.getRaidID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_LOGFRAME_FK_ID, raidModel.getLogFrameModel().getLogFrameID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_RAID_CATEGORY_FK_ID,</span>
                <span class="s1">raidModel.getRaidCategoryModel().getRaidCategoryID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ORIGINATOR_FK_ID, raidModel.getOriginatorModel().getHumanSetID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_OWNER_FK_ID, raidModel.getOwnerModel().getHumanSetID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_FREQUENCY_FK_ID, raidModel.getFrequencyModel().getFrequencyID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_RAID_LIKELIHOOD_FK_ID,</span>
                <span class="s1">raidModel.getRaidLikelihoodModel().getRaidLikelihoodID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_RAID_IMPACT_FK_ID, raidModel.getRaidImpactModel().getRaidImpactID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_ROBOT_FK_ID, raidModel.getRobotModel().getRobotID());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_SCORE, raidModel.getScore());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_NAME, raidModel.getName());</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_DESCRIPTION, raidModel.getDescription());</span>

        <span class="s2">// insert project details</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s0">if </span><span class="s1">(db.insert(cSQLDBHelper.TABLE_tblRAID, </span><span class="s0">null</span><span class="s1">, cv) &lt; </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

            <span class="s2">// add component raid</span>
            <span class="s0">for </span><span class="s1">(Pair&lt;Long, Long&gt; pair : crSet) {</span>
                <span class="s0">if </span><span class="s1">(!addComponentRaid(pair.first, pair.second))</span>
                    <span class="s0">return false</span><span class="s1">;</span>
            <span class="s1">}</span>

        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception e) {</span>
            <span class="s1">Log.d(TAG, </span><span class="s5">&quot;Exception in importing RAID from Excel: &quot; </span><span class="s1">+ e.getMessage());</span>
        <span class="s1">}</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s0">public boolean </span><span class="s1">addComponentRaid(</span><span class="s0">long </span><span class="s1">componentID, </span><span class="s0">long </span><span class="s1">raidID) {</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s1">ContentValues cv = </span><span class="s0">new </span><span class="s1">ContentValues();</span>

        <span class="s1">cv.put(cSQLDBHelper.KEY_COMPONENT_FK_ID, componentID);</span>
        <span class="s1">cv.put(cSQLDBHelper.KEY_RAID_FK_ID, raidID);</span>

        <span class="s0">return </span><span class="s1">db.insert(cSQLDBHelper.TABLE_tblCOMPONENT_RAID, </span><span class="s0">null</span><span class="s1">, cv) &gt;= </span><span class="s4">0</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteRaids() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblRAID, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s1">@Override</span>
    <span class="s0">public boolean </span><span class="s1">deleteComponentRaids() {</span>
        <span class="s2">// open the connection to the database</span>
        <span class="s1">SQLiteDatabase db = dbHelper.getWritableDatabase();</span>

        <span class="s2">// delete all records</span>
        <span class="s0">long </span><span class="s1">result = db.delete(cSQLDBHelper.TABLE_tblCOMPONENT_RAID, </span><span class="s0">null</span><span class="s1">,</span>
                <span class="s0">null</span><span class="s1">);</span>

        <span class="s2">// close the database connection</span>
        <span class="s1">db.close();</span>

        <span class="s0">return </span><span class="s1">result &gt; -</span><span class="s4">1</span><span class="s1">;</span>
    <span class="s1">}</span>


<span class="s2">//    /* ######################################## IMPACT FUNCTIONS ########################################*/</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * This function extracts and adds the impact data from excel.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean addImpactFromExcel() {</span>
<span class="s2">//        Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
<span class="s2">//        Sheet impactSheet = workbook.getSheet(cExcelHelper.SHEET_tblIMPACT);</span>
<span class="s2">//</span>
<span class="s2">//        if (impactSheet == null) {</span>
<span class="s2">//            return false;</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        for (Row cRow : impactSheet) {</span>
<span class="s2">//            //just skip the row if row number is 0</span>
<span class="s2">//            if (cRow.getRowNum() == 0) {</span>
<span class="s2">//                continue;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            cImpactModel impactModel = new cImpactModel();</span>
<span class="s2">//</span>
<span class="s2">//            impactModel.setImpactID((int) cRow.getCell(0,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            impactModel.setParentID((int) cRow.getCell(1,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            impactModel.setLogFrameID((int) cRow.getCell(2,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            impactModel.setName(cRow.getCell(3,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//            impactModel.setDescription(cRow.getCell(4,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//</span>
<span class="s2">//            /* get questions grouped by criteria of the impact */</span>
<span class="s2">//            Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; iqcMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; qcSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long impactID, questionID, criteriaID;</span>
<span class="s2">//</span>
<span class="s2">//            Sheet iqcSheet = workbook.getSheet(cExcelHelper.SHEET_tblIMPACT_QUESTION);</span>
<span class="s2">//            for (Row rowIQC : iqcSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowIQC.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                impactID = (int) rowIQC.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (impactModel.getImpactID() == impactID) {</span>
<span class="s2">//                    questionID = (int) rowIQC.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    criteriaID = (int) rowIQC.getCell(2,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    qcSet.add(new Pair&lt;&gt;(questionID, criteriaID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* get raids of the impact */</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; raidSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long raidID;</span>
<span class="s2">//            Sheet impactRaidSheet = workbook.getSheet(cExcelHelper.SHEET_tblIMPACT_RAID);</span>
<span class="s2">//            for (Row rowImpactRaid : impactRaidSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowImpactRaid.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                impactID = (int) rowImpactRaid.getCell(1,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (impactModel.getImpactID() == impactID) {</span>
<span class="s2">//                    raidID = (int) rowImpactRaid.getCell(0,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    raidSet.add(new Pair&lt;&gt;(raidID, impactID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            iqcMap.put(impactModel.getImpactID(), qcSet);</span>
<span class="s2">//</span>
<span class="s2">//            //Gson gson = new Gson();</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(raidSet));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(iqcMap));</span>
<span class="s2">//</span>
<span class="s2">//            if (!addImpactFromExcel(impactModel, iqcMap, raidSet)) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * This function extracts and adds the impact data from excel.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @param impactModel impact model</span>
<span class="s2">//     * @param iqcMap      impact question criteria</span>
<span class="s2">//     * @param raidSet     raid set</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addImpactFromExcel(cImpactModel impactModel,</span>
<span class="s2">//                                      Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; iqcMap,</span>
<span class="s2">//                                      Set&lt;Pair&lt;Long, Long&gt;&gt; raidSet) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, impactModel.getImpactID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, impactModel.getParentID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_LOGFRAME_FK_ID, impactModel.getLogFrameID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_NAME, impactModel.getName());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_DESCRIPTION, impactModel.getDescription());</span>
<span class="s2">//</span>
<span class="s2">//        // insert project details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblIMPACT, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add impact, question and criteria tuple</span>
<span class="s2">//            for (Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; iqcEntry : iqcMap.entrySet()) {</span>
<span class="s2">//                long impactID = iqcEntry.getKey();</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; qcPair : iqcEntry.getValue()) {</span>
<span class="s2">//                    long questionID = qcPair.first;</span>
<span class="s2">//                    long criteriaID = qcPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addImpactQuestionCriteria(impactID, questionID, criteriaID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add raid</span>
<span class="s2">//            for (Pair&lt;Long, Long&gt; pair : raidSet) {</span>
<span class="s2">//                if (!addImpactRaid(pair.first, pair.second))</span>
<span class="s2">//                    return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing IMPACT from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * This function adds the impact, question and criteria to the database.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @param impactID   impact identification</span>
<span class="s2">//     * @param questionID question identification</span>
<span class="s2">//     * @param criteriaID criteria identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addImpactQuestionCriteria(long impactID, long questionID, long criteriaID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_IMPACT_FK_ID, impactID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_EVALUATION_CRITERIA_FK_ID, criteriaID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblIMPACT_QUESTION, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * This function adds the impact and raid to the database.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @param impactID impact identification</span>
<span class="s2">//     * @param raidID   raid identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addImpactRaid(long impactID, long raidID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_IMPACT_FK_ID, impactID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_RAID_FK_ID, raidID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblIMPACT_RAID, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteImpactQuestions() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblIMPACT_QUESTION, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteImpactRaids() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblIMPACT_RAID, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteImpacts() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblIMPACT, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>

    <span class="s2">/* ######################################## OUTCOME FUNCTIONS ########################################*/</span>

<span class="s2">//    /**</span>
<span class="s2">//     * This function extracts and adds the outcome data from excel.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean addOutcomeFromExcel() {</span>
<span class="s2">//        Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
<span class="s2">//        Sheet outcomeSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTCOME);</span>
<span class="s2">//        Gson gson = new Gson();</span>
<span class="s2">//        if (outcomeSheet == null) {</span>
<span class="s2">//            return false;</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        for (Row cRow : outcomeSheet) {</span>
<span class="s2">//            //just skip the row if row number is 0</span>
<span class="s2">//            if (cRow.getRowNum() == 0) {</span>
<span class="s2">//                continue;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            cOutcomeModel outcomeModel = new cOutcomeModel();</span>
<span class="s2">//</span>
<span class="s2">//            outcomeModel.setOutcomeID((int) cRow.getCell(0,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            outcomeModel.setParentID((int) cRow.getCell(1,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            outcomeModel.setImpactID((int) cRow.getCell(2,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            outcomeModel.setLogFrameID((int) cRow.getCell(3,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            outcomeModel.setName(cRow.getCell(4,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//            outcomeModel.setDescription(cRow.getCell(5,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//</span>
<span class="s2">//            /* get questions grouped by criteria of the outcome */</span>
<span class="s2">//            Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; oqcMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; qcSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long outcomeID, questionID, criteriaID;</span>
<span class="s2">//</span>
<span class="s2">//            Sheet oqcSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTCOME_QUESTION);</span>
<span class="s2">//            for (Row rowOQC : oqcSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowOQC.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                outcomeID = (int) rowOQC.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (outcomeModel.getOutcomeID() == outcomeID) {</span>
<span class="s2">//                    questionID = (int) rowOQC.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    criteriaID = (int) rowOQC.getCell(2,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    qcSet.add(new Pair&lt;&gt;(questionID, criteriaID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//            oqcMap.put(outcomeModel.getOutcomeID(), qcSet);</span>
<span class="s2">//</span>
<span class="s2">//            /* get impacts of the outcome for a sub-logframe */</span>
<span class="s2">//            Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; soiMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            long parentID, childID, impactID;</span>
<span class="s2">//</span>
<span class="s2">//            Sheet oiSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTCOME_IMPACT);</span>
<span class="s2">//            for (Row rowOI : oiSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowOI.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                outcomeID = (int) rowOI.getCell(2, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (outcomeModel.getOutcomeID() == outcomeID) {</span>
<span class="s2">//                    Set&lt;Pair&lt;Long, Long&gt;&gt; impactSet = new HashSet&lt;&gt;();</span>
<span class="s2">//                    parentID = (int) rowOI.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    childID = (int) rowOI.getCell(1, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    impactID = (int) rowOI.getCell(3, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    impactSet.add(new Pair&lt;&gt;(outcomeID, impactID));</span>
<span class="s2">//                    soiMap.put(impactSet, new Pair&lt;&gt;(parentID, childID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* get raids of the outcome */</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; raidSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long raidID;</span>
<span class="s2">//            Sheet outcomeRaidSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTCOME_RAID);</span>
<span class="s2">//            for (Row rowOutcomeRaid : outcomeRaidSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowOutcomeRaid.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                outcomeID = (int) rowOutcomeRaid.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (outcomeModel.getOutcomeID() == outcomeID) {</span>
<span class="s2">//                    raidID = (int) rowOutcomeRaid.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    raidSet.add(new Pair&lt;&gt;(outcomeID, raidID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(osiMap));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(oqcMap));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(raidSet));</span>
<span class="s2">//</span>
<span class="s2">//            if (!addOutcomeFromExcel(outcomeModel, soiMap, oqcMap, raidSet)) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param outcomeModel outcome model</span>
<span class="s2">//     * @param soiMap       sub-logframe outcome impact</span>
<span class="s2">//     * @param oqcMap       outcome question criteria</span>
<span class="s2">//     * @param raidSet      raid set</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addOutcomeFromExcel(cOutcomeModel outcomeModel,</span>
<span class="s2">//                                       Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; soiMap,</span>
<span class="s2">//                                       Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; oqcMap,</span>
<span class="s2">//                                       Set&lt;Pair&lt;Long, Long&gt;&gt; raidSet) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, outcomeModel.getOutcomeID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, outcomeModel.getParentID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_IMPACT_FK_ID, outcomeModel.getImpactID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_LOGFRAME_FK_ID, outcomeModel.getLogFrameID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_NAME, outcomeModel.getName());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_DESCRIPTION, outcomeModel.getDescription());</span>
<span class="s2">//</span>
<span class="s2">//        // insert project details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblOUTCOME, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add sub-logFrame, outcome and impact tuple</span>
<span class="s2">//            for (Map.Entry&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; soiEntry :</span>
<span class="s2">//                    soiMap.entrySet()) {</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; oiPair : soiEntry.getKey()) {</span>
<span class="s2">//                    long outcomeID = oiPair.first;</span>
<span class="s2">//                    long impactID = oiPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    Pair&lt;Long, Long&gt; sPair = soiEntry.getValue();</span>
<span class="s2">//                    long parentID = sPair.first;</span>
<span class="s2">//                    long childID = sPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addOutcomeImpact(parentID, childID, outcomeID, impactID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//</span>
<span class="s2">//            // add outcome, question and criteria tuple</span>
<span class="s2">//            for (Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; oqcEntry : oqcMap.entrySet()) {</span>
<span class="s2">//                long impactID = oqcEntry.getKey();</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; qcPair : oqcEntry.getValue()) {</span>
<span class="s2">//                    long questionID = qcPair.first;</span>
<span class="s2">//                    long criteriaID = qcPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addOutcomeQuestionCriteria(impactID, questionID, criteriaID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add outcome raid</span>
<span class="s2">//            for (Pair&lt;Long, Long&gt; pair : raidSet) {</span>
<span class="s2">//                long raidID = pair.first;</span>
<span class="s2">//                long outcomeID = pair.second;</span>
<span class="s2">//                if (!addOutcomeRaid(outcomeID, raidID))</span>
<span class="s2">//                    return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing OUTCOME from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param outcomeID  outcome identification</span>
<span class="s2">//     * @param questionID question identification</span>
<span class="s2">//     * @param criteriaID criteria identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addOutcomeQuestionCriteria(long outcomeID, long questionID, long criteriaID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTCOME_FK_ID, outcomeID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_EVALUATION_CRITERIA_FK_ID, criteriaID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblOUTCOME_QUESTION, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param outcomeID outcome identification</span>
<span class="s2">//     * @param raidID    raid identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addOutcomeRaid(long outcomeID, long raidID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTCOME_FK_ID, outcomeID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_RAID_FK_ID, raidID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblOUTCOME_RAID, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteOutcomeImpacts() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblOUTCOME_IMPACT, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteOutcomeQuestions() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblOUTCOME_QUESTION, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteOutcomeRaids() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblOUTCOME_RAID, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteOutcomes() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblOUTCOME, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>

    <span class="s2">/* ######################################## OUTPUT FUNCTIONS ########################################*/</span>

<span class="s2">//    /**</span>
<span class="s2">//     * This function extracts and adds the output data from excel.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean addOutputFromExcel() {</span>
<span class="s2">//        Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
<span class="s2">//        Sheet outputSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTPUT);</span>
<span class="s2">//</span>
<span class="s2">//        if (outputSheet == null) {</span>
<span class="s2">//            return false;</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        for (Row cRow : outputSheet) {</span>
<span class="s2">//            //just skip the row if row number is 0</span>
<span class="s2">//            if (cRow.getRowNum() == 0) {</span>
<span class="s2">//                continue;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            cOutputModel outputModel = new cOutputModel();</span>
<span class="s2">//</span>
<span class="s2">//            outputModel.setOutputID((int) cRow.getCell(0,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            outputModel.setParentID((int) cRow.getCell(1,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            outputModel.setOutcomeID((int) cRow.getCell(2,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            outputModel.setLogFrameID((int) cRow.getCell(3,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            outputModel.setName(cRow.getCell(4,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//            outputModel.setDescription(cRow.getCell(5,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//</span>
<span class="s2">//            /* get questions grouped by criteria of the output */</span>
<span class="s2">//            Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; oqcMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; qcSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long outputID, questionID, criteriaID;</span>
<span class="s2">//</span>
<span class="s2">//            Sheet oqcSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTPUT_QUESTION);</span>
<span class="s2">//            for (Row rowOQC : oqcSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowOQC.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                outputID = (int) rowOQC.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (outputModel.getOutputID() == outputID) {</span>
<span class="s2">//                    questionID = (int) rowOQC.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    criteriaID = (int) rowOQC.getCell(2,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    qcSet.add(new Pair&lt;&gt;(questionID, criteriaID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//            oqcMap.put(outputModel.getOutputID(), qcSet);</span>
<span class="s2">//</span>
<span class="s2">//            /* get outcomes of the output for a sub-logframe */</span>
<span class="s2">//            Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; sooMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            long parentID, childID, outcomeID;</span>
<span class="s2">//</span>
<span class="s2">//            Sheet ooSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTPUT_OUTCOME);</span>
<span class="s2">//            for (Row rowOO : ooSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowOO.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                outputID = (int) rowOO.getCell(2, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (outputModel.getOutputID() == outputID) {</span>
<span class="s2">//                    Set&lt;Pair&lt;Long, Long&gt;&gt; impactSet = new HashSet&lt;&gt;();</span>
<span class="s2">//                    parentID = (int) rowOO.getCell(0,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    childID = (int) rowOO.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    outcomeID = (int) rowOO.getCell(3,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    impactSet.add(new Pair(outputID, outcomeID));</span>
<span class="s2">//                    sooMap.put(impactSet, new Pair&lt;&gt;(parentID, childID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* get raids of the output */</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; raidSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long raidID;</span>
<span class="s2">//            Sheet outputRaidSheet = workbook.getSheet(cExcelHelper.SHEET_tblOUTPUT_RAID);</span>
<span class="s2">//            for (Row rowOutputRaid : outputRaidSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowOutputRaid.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                outputID = (int) rowOutputRaid.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (outputModel.getOutputID() == outputID) {</span>
<span class="s2">//                    raidID = (int) rowOutputRaid.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    raidSet.add(new Pair&lt;&gt;(outputID, raidID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(sooMap));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(oqcMap));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(raidSet));</span>
<span class="s2">//</span>
<span class="s2">//            if (!addOutputFromExcel(outputModel, sooMap, oqcMap, raidSet)) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param outputModel output model</span>
<span class="s2">//     * @param sooMap      sub-logframe output outcome</span>
<span class="s2">//     * @param oqcMap      output question criteria</span>
<span class="s2">//     * @param raidSet     raid set</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addOutputFromExcel(cOutputModel outputModel,</span>
<span class="s2">//                                      Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; sooMap,</span>
<span class="s2">//                                      Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; oqcMap,</span>
<span class="s2">//                                      Set&lt;Pair&lt;Long, Long&gt;&gt; raidSet) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, outputModel.getOutputID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, outputModel.getParentID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTCOME_FK_ID, outputModel.getOutcomeID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_LOGFRAME_FK_ID, outputModel.getLogFrameID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_NAME, outputModel.getName());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_DESCRIPTION, outputModel.getDescription());</span>
<span class="s2">//</span>
<span class="s2">//        // insert output details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblOUTPUT, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add sub-logFrame, outcome and impact tuple</span>
<span class="s2">//            for (Map.Entry&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; sooEntry :</span>
<span class="s2">//                    sooMap.entrySet()) {</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; ooPair : sooEntry.getKey()) {</span>
<span class="s2">//                    long outputID = ooPair.first;</span>
<span class="s2">//                    long outcomeID = ooPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    Pair&lt;Long, Long&gt; sPair = sooEntry.getValue();</span>
<span class="s2">//                    long parentID = sPair.first;</span>
<span class="s2">//                    long childID = sPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addOutputOutcome(parentID, childID, outputID, outcomeID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add output, question and criteria tuple</span>
<span class="s2">//            for (Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; oqcEntry : oqcMap.entrySet()) {</span>
<span class="s2">//                long outputID = oqcEntry.getKey();</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; qcPair : oqcEntry.getValue()) {</span>
<span class="s2">//                    long questionID = qcPair.first;</span>
<span class="s2">//                    long criteriaID = qcPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addOutputQuestionCriteria(outputID, questionID, criteriaID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add output raid</span>
<span class="s2">//            for (Pair&lt;Long, Long&gt; pair : raidSet) {</span>
<span class="s2">//                long raidID = pair.first;</span>
<span class="s2">//                long outputID = pair.second;</span>
<span class="s2">//                if (!addOutputRaid(outputID, raidID))</span>
<span class="s2">//                    return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing OUTPUT from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param parentID  parent identification</span>
<span class="s2">//     * @param childID   child identification</span>
<span class="s2">//     * @param outputID  output identification</span>
<span class="s2">//     * @param outcomeID outcome identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addOutputOutcome(long parentID, long childID, long outputID, long outcomeID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, parentID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_CHILD_FK_ID, childID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTPUT_FK_ID, outputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTCOME_FK_ID, outcomeID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblOUTPUT_OUTCOME, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param outputID   output identification</span>
<span class="s2">//     * @param questionID question identification</span>
<span class="s2">//     * @param criteriaID criteria identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addOutputQuestionCriteria(long outputID, long questionID, long criteriaID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTPUT_FK_ID, outputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_EVALUATION_CRITERIA_FK_ID, criteriaID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblOUTPUT_QUESTION, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param outputID output identification</span>
<span class="s2">//     * @param raidID   raid identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addOutputRaid(long outputID, long raidID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTPUT_FK_ID, outputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_RAID_FK_ID, raidID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblOUTPUT_RAID, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteOutputOutcomes() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblOUTPUT_OUTCOME, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteOutputQuestions() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblOUTPUT_QUESTION, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteOutputRaids() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblOUTPUT_RAID, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteOutputs() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblOUTPUT, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>

    <span class="s2">/* #################################### WORKPLAN FUNCTIONS ###################################*/</span>

<span class="s2">//    /**</span>
<span class="s2">//     * This function extracts criteria data from excel and adds it to the database.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean addWorkplanFromExcel() {</span>
<span class="s2">//        Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
<span class="s2">//        Sheet WPSheet = workbook.getSheet(cExcelHelper.SHEET_tblWORKPLAN);</span>
<span class="s2">//</span>
<span class="s2">//        if (WPSheet == null) {</span>
<span class="s2">//            return false;</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        for (Row cRow : WPSheet) {</span>
<span class="s2">//            //just skip the row if row number is 0</span>
<span class="s2">//            if (cRow.getRowNum() == 0) {</span>
<span class="s2">//                continue;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            cWorkplanModel workplanModel = new cWorkplanModel();</span>
<span class="s2">//</span>
<span class="s2">//            workplanModel.setWorkplanID((int)</span>
<span class="s2">//                    cRow.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            workplanModel.setLogFrameID((int)</span>
<span class="s2">//                    cRow.getCell(1, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            workplanModel.setName(</span>
<span class="s2">//                    cRow.getCell(2, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//            workplanModel.setDescription(</span>
<span class="s2">//                    cRow.getCell(3, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//</span>
<span class="s2">//            if (!addWorkplan(workplanModel)) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * This function adds criteria data to the database.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @param workplanModel workplan model</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addWorkplan(cWorkplanModel workplanModel) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, workplanModel.getWorkplanID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_LOGFRAME_FK_ID, workplanModel.getLogFrameID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_NAME, workplanModel.getName());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_DESCRIPTION, workplanModel.getDescription());</span>
<span class="s2">//</span>
<span class="s2">//        // insert project details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblWORKPLAN, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing WORKPLAN from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteWorkPlans() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblWORKPLAN, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>

    <span class="s2">/* ###################################### ACTIVITY FUNCTIONS ######################################*/</span>


<span class="s2">//    /**</span>
<span class="s2">//     * This function extracts and adds the activity data from excel.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean addActivityFromExcel() {</span>
<span class="s2">//        Gson gson = new Gson();</span>
<span class="s2">//        Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
<span class="s2">//        Sheet ASheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITY);</span>
<span class="s2">//</span>
<span class="s2">//        if (ASheet == null) {</span>
<span class="s2">//            return false;</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        for (Row rowActivity : ASheet) {</span>
<span class="s2">//</span>
<span class="s2">//            //just skip the row if row number is 0</span>
<span class="s2">//            if (rowActivity.getRowNum() == 0) {</span>
<span class="s2">//                continue;</span>
<span class="s2">//            }</span>
<span class="s2">//            cActivityModel activityModel = new cActivityModel();</span>
<span class="s2">//</span>
<span class="s2">//            activityModel.setWorkplanID((int)</span>
<span class="s2">//                    rowActivity.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            activityModel.setParentID((int)</span>
<span class="s2">//                    rowActivity.getCell(1, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            activityModel.setOutputID((int)</span>
<span class="s2">//                    rowActivity.getCell(2, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//</span>
<span class="s2">//            /* get preceding activities of the activity*/</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; precedingSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long precedingActivityID, succeedingActivityID;</span>
<span class="s2">//            Sheet precedingActivitySheet = workbook.getSheet(cExcelHelper.SHEET_tblPRECEDINGACTIVITY);</span>
<span class="s2">//            for (Row rowPrecedingActivity : precedingActivitySheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowPrecedingActivity.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                precedingActivityID = (int) rowPrecedingActivity.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (activityModel.getWorkplanID() == precedingActivityID) {</span>
<span class="s2">//                    succeedingActivityID = (int) rowPrecedingActivity.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    precedingSet.add(new Pair&lt;&gt;(precedingActivityID, succeedingActivityID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* get activity assignment */</span>
<span class="s2">//            Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; asaMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; asSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long assignmentID, staffID, assignedActivityID;</span>
<span class="s2">//</span>
<span class="s2">//            Sheet aqaSheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITYASSIGNMENT);</span>
<span class="s2">//            for (Row rowAQA : aqaSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowAQA.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                assignedActivityID = (int) rowAQA.getCell(2,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (activityModel.getWorkplanID() == assignedActivityID) {</span>
<span class="s2">//                    staffID = (int) rowAQA.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    assignmentID = (int) rowAQA.getCell(0,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    asSet.add(new Pair&lt;&gt;(assignmentID, staffID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//            asaMap.put(activityModel.getWorkplanID(), asSet);</span>
<span class="s2">//</span>
<span class="s2">//</span>
<span class="s2">//            /* get questions grouped by criteria of the activity */</span>
<span class="s2">//            Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; aqcMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; qcSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long activityID, questionID, criteriaID;</span>
<span class="s2">//</span>
<span class="s2">//            Sheet aqcSheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITY_QUESTION);</span>
<span class="s2">//            for (Row rowAQC : aqcSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowAQC.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                activityID = (int) rowAQC.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (activityModel.getWorkplanID() == activityID) {</span>
<span class="s2">//                    questionID = (int) rowAQC.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    criteriaID = (int) rowAQC.getCell(2,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    qcSet.add(new Pair&lt;&gt;(questionID, criteriaID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//            aqcMap.put(activityModel.getOutputID(), qcSet);</span>
<span class="s2">//</span>
<span class="s2">//            /* get outputs of the activity for a sub-logframe */</span>
<span class="s2">//            Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; saoMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            long parentID, childID, outputID;</span>
<span class="s2">//</span>
<span class="s2">//            Sheet aoSheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITY_OUTPUT);</span>
<span class="s2">//            for (Row rowAO : aoSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowAO.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                activityID = (int) rowAO.getCell(2,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (activityModel.getWorkplanID() == activityID) {</span>
<span class="s2">//                    Set&lt;Pair&lt;Long, Long&gt;&gt; AOSet = new HashSet&lt;&gt;();</span>
<span class="s2">//                    parentID = (int) rowAO.getCell(0,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    childID = (int) rowAO.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    outputID = (int) rowAO.getCell(3,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    AOSet.add(new Pair(activityID, outputID));</span>
<span class="s2">//                    saoMap.put(AOSet, new Pair&lt;&gt;(parentID, childID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* get raids of the activity */</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; raidSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long raidID;</span>
<span class="s2">//            Sheet activityRaidSheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITY_RAID);</span>
<span class="s2">//            for (Row rowActivityRaid : activityRaidSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowActivityRaid.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                activityID = (int) rowActivityRaid.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (activityModel.getWorkplanID() == activityID) {</span>
<span class="s2">//                    raidID = (int) rowActivityRaid.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    raidSet.add(new Pair&lt;&gt;(activityID, raidID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(activityModel));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(precedingSet));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(asaMap));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(aqcMap));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(saoMap));</span>
<span class="s2">//            //Log.d(TAG, gson.toJson(raidSet));</span>
<span class="s2">//</span>
<span class="s2">//            if (!addActivity(activityModel, precedingSet, asaMap, saoMap, aqcMap, raidSet)) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>

    <span class="s2">/* get activities of the activity planning*/</span>
    <span class="s2">//Set&lt;Pair&lt;Integer, Integer&gt;&gt; planningSet = new HashSet&lt;&gt;();</span>
<span class="s2">/* 
            int activityID; 
            Sheet activitySheet = workbook.getSheet(cExcelHelper.SHEET_tblACTIVITY); 
            for (Iterator&lt;Row&gt; ritActivity = activitySheet.iterator(); ritActivity.hasNext(); ) { 
                Row rowActivity = ritActivity.next(); 
 
                //just skip the row if row number is 0 
                if (rowActivity.getRowNum() == 0) { 
                    continue; 
                } 
 
                activityID = (int) rowActivity.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue(); 
                if (activityPlanningModel.getActivityPlanningID() == activityID) { 
                    activityModel.setActivityID((int) 
                            rowActivity.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue()); 
                    activityModel.setParentID ((int) 
                            rowActivity.getCell(1, Row.CREATE_NULL_AS_BLANK).getNumericCellValue()); 
                    activityModel.setOutputID ((int) 
                            rowActivity.getCell(2, Row.CREATE_NULL_AS_BLANK).getNumericCellValue()); 
                    //activityModel.setLogFrameID((int) 
                    //        rowActivity.getCell(3, Row.CREATE_NULL_AS_BLANK).getNumericCellValue()); 
                    break; 
                } 
            } 
        } 
 
        return true; 
    }*/</span>

<span class="s2">//    /**</span>
<span class="s2">//     * @param activityModel activity model</span>
<span class="s2">//     * @param precedingSet  preceding set</span>
<span class="s2">//     * @param saoMap        sub-activity output</span>
<span class="s2">//     * @param aqcMap        activity question criteria</span>
<span class="s2">//     * @param raidSet       raid set</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addActivity(cActivityModel activityModel,</span>
<span class="s2">//                               Set&lt;Pair&lt;Long, Long&gt;&gt; precedingSet,</span>
<span class="s2">//                               Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; asaMap,</span>
<span class="s2">//                               Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; saoMap,</span>
<span class="s2">//                               Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; aqcMap,</span>
<span class="s2">//                               Set&lt;Pair&lt;Long, Long&gt;&gt; raidSet) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_WORKPLAN_FK_ID, activityModel.getWorkplanID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, activityModel.getParentID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTPUT_FK_ID, activityModel.getOutputID());</span>
<span class="s2">//</span>
<span class="s2">//        // insert activity details</span>
<span class="s2">//        try {</span>
<span class="s2">//</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblACTIVITY, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add preceding activity</span>
<span class="s2">//            for (Pair&lt;Long, Long&gt; pair : precedingSet) {</span>
<span class="s2">//                long succeedingID = pair.first;</span>
<span class="s2">//                long precedingID = pair.second;</span>
<span class="s2">//                if (!addPrecedingActivity(succeedingID, precedingID))</span>
<span class="s2">//                    return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add assignment, staff and activity tuple</span>
<span class="s2">//            for (Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; asaEntry : asaMap.entrySet()) {</span>
<span class="s2">//                long activityID = asaEntry.getKey();</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; saPair : asaEntry.getValue()) {</span>
<span class="s2">//                    long assignmentID = saPair.first;</span>
<span class="s2">//                    long staffID = saPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addActivityAssignment(assignmentID, staffID, activityID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add sub-logFrame, activity and output tuple</span>
<span class="s2">//            for (Map.Entry&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; saoEntry : saoMap.entrySet()) {</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; aoPair : saoEntry.getKey()) {</span>
<span class="s2">//                    long activityID = aoPair.first;</span>
<span class="s2">//                    long outputID = aoPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    Pair&lt;Long, Long&gt; sPair = saoEntry.getValue();</span>
<span class="s2">//                    long parentID = sPair.first;</span>
<span class="s2">//                    long childID = sPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addActivityOutput(parentID, childID, activityID, outputID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add activity, question and criteria tuple</span>
<span class="s2">//            for (Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; aqcEntry : aqcMap.entrySet()) {</span>
<span class="s2">//                long activityID = aqcEntry.getKey();</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; qcPair : aqcEntry.getValue()) {</span>
<span class="s2">//                    long questionID = qcPair.first;</span>
<span class="s2">//                    long criteriaID = qcPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addActivityQuestionCriteria(activityID, questionID, criteriaID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add activity raid</span>
<span class="s2">//            for (Pair&lt;Long, Long&gt; pair : raidSet) {</span>
<span class="s2">//                long raidID = pair.first;</span>
<span class="s2">//                long activityID = pair.second;</span>
<span class="s2">//                if (!addActivityRaid(activityID, raidID))</span>
<span class="s2">//                    return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing ACTIVITY from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param activityID  activity identification</span>
<span class="s2">//     * @param precedingID preceding identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addPrecedingActivity(long activityID, long precedingID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_WORKPLAN_FK_ID, activityID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_PRECEDING_ACTIVITY_FK_ID, precedingID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblPRECEDINGACTIVITY, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param assignmentID assignment identification</span>
<span class="s2">//     * @param staffID      staff identification</span>
<span class="s2">//     * @param activityID   activity identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addActivityAssignment(long assignmentID, long staffID, long activityID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, assignmentID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_STAFF_FK_ID, staffID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_WORKPLAN_FK_ID, activityID);</span>
<span class="s2">//</span>
<span class="s2">//        if (db.insert(cSQLDBHelper.TABLE_tblACTIVITYASSIGNMENT, null, cv) &lt; 0) {</span>
<span class="s2">//            return false;</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param parentID   parent identification</span>
<span class="s2">//     * @param childID    child identification</span>
<span class="s2">//     * @param activityID activity identification</span>
<span class="s2">//     * @param outputID   output identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addActivityOutput(long parentID, long childID, long activityID, long outputID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, parentID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_CHILD_FK_ID, childID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_WORKPLAN_FK_ID, activityID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_OUTPUT_FK_ID, outputID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblACTIVITY_OUTPUT, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param activityID activity identification</span>
<span class="s2">//     * @param questionID question identification</span>
<span class="s2">//     * @param criteriaID criteria identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addActivityQuestionCriteria(long activityID, long questionID, long criteriaID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_WORKPLAN_FK_ID, activityID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_EVALUATION_CRITERIA_FK_ID, criteriaID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblACTIVITY_QUESTION, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param activityID activity identification</span>
<span class="s2">//     * @param raidID     raid identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addActivityRaid(long activityID, long raidID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_WORKPLAN_FK_ID, activityID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_RAID_FK_ID, raidID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblACTIVITY_RAID, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deletePrecedingActivities() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblPRECEDINGACTIVITY, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteActivityAssignments() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblACTIVITYASSIGNMENT, null,</span>
<span class="s2">//                null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteActivityOutputs() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblACTIVITY_OUTPUT, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteActivityQuestions() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblACTIVITY_QUESTION, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteActivityRaids() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblACTIVITY_RAID, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    public boolean deleteActivities() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblACTIVITY, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>





    <span class="s2">/*#################################### RESOURCE FUNCTIONS ####################################*/</span>

<span class="s2">//    /**</span>
<span class="s2">//     * This function extracts resource type data from excel and adds it to the database.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean addResourceFromExcel() {</span>
<span class="s2">//        Workbook workbook = excelHelper.getWorkbookLOGFRAME();</span>
<span class="s2">//        Sheet RSheet = workbook.getSheet(cExcelHelper.SHEET_tblRESOURCE);</span>
<span class="s2">//</span>
<span class="s2">//        if (RSheet == null) {</span>
<span class="s2">//            return false;</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        for (Row cRow : RSheet) {</span>
<span class="s2">//            //just skip the row if row number is 0</span>
<span class="s2">//            if (cRow.getRowNum() == 0) {</span>
<span class="s2">//                continue;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            cResourceModel resourceModel = new cResourceModel();</span>
<span class="s2">//</span>
<span class="s2">//            resourceModel.setResourceID((int)</span>
<span class="s2">//                    cRow.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            resourceModel.setResourceTypeID((int)</span>
<span class="s2">//                    cRow.getCell(1, Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            resourceModel.setName(</span>
<span class="s2">//                    cRow.getCell(2, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//            resourceModel.setDescription(</span>
<span class="s2">//                    cRow.getCell(3, Row.CREATE_NULL_AS_BLANK).getStringCellValue());</span>
<span class="s2">//</span>
<span class="s2">//            if (!addResource(resourceModel)) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * This function adds resource data to the database.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @param resourceModel resource model</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    public boolean addResource(cResourceModel resourceModel) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, resourceModel.getResourceID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_RESOURCE_TYPE_FK_ID, resourceModel.getResourceTypeID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_NAME, resourceModel.getName());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_DESCRIPTION, resourceModel.getDescription());</span>
<span class="s2">//</span>
<span class="s2">//        // insert project details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblRESOURCE, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing RESOURCE from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteResources() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblRESOURCE, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>

    <span class="s2">/*###################################### INPUT FUNCTIONS #####################################*/</span>

<span class="s2">//    /**</span>
<span class="s2">//     * This function extracts and adds the input data from excel.</span>
<span class="s2">//     *</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean addInputFromExcel() {</span>
<span class="s2">//        Workbook logFrameWorkbook = excelHelper.getWorkbookLOGFRAME();</span>
<span class="s2">//        Workbook awpbWorkbook = excelHelper.getWorkbookAWPB();</span>
<span class="s2">//</span>
<span class="s2">//        Sheet inputSheet = logFrameWorkbook.getSheet(cExcelHelper.SHEET_tblINPUT);</span>
<span class="s2">//        Sheet iqcSheet = logFrameWorkbook.getSheet(cExcelHelper.SHEET_tblINPUT_QUESTION);</span>
<span class="s2">//        Sheet iaSheet = logFrameWorkbook.getSheet(cExcelHelper.SHEET_tblINPUT_ACTIVITY);</span>
<span class="s2">//        Sheet humanSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblHUMAN);</span>
<span class="s2">//        Sheet humanSetSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblHUMANSET);</span>
<span class="s2">//        Sheet materialSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblMATERIAL);</span>
<span class="s2">//        Sheet incomeSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblINCOME);</span>
<span class="s2">//        Sheet fundSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblFUND);</span>
<span class="s2">//        Sheet expenseSheet = awpbWorkbook.getSheet(cExcelHelper.SHEET_tblEXPENSE);</span>
<span class="s2">//</span>
<span class="s2">//        if (inputSheet == null) {</span>
<span class="s2">//            return false;</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        for (Row cRow : inputSheet) {</span>
<span class="s2">//            //just skip the row if row number is 0</span>
<span class="s2">//            if (cRow.getRowNum() == 0) {</span>
<span class="s2">//                continue;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            cInputModel inputModel = new cInputModel();</span>
<span class="s2">//</span>
<span class="s2">//            inputModel.setInputID((int) cRow.getCell(0,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            inputModel.setWorkplanID((int) cRow.getCell(1,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            inputModel.setLogFrameID((int) cRow.getCell(2,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//            inputModel.setResourceID((int) cRow.getCell(3,</span>
<span class="s2">//                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue());</span>
<span class="s2">//</span>
<span class="s2">//            /* get questions grouped by criteria of the input */</span>
<span class="s2">//            Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; iqcMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; qcSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long inputID, questionID, criteriaID;</span>
<span class="s2">//</span>
<span class="s2">//            for (Row rowIQC : iqcSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowIQC.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//                inputID = (long) rowIQC.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (inputModel.getInputID() == inputID) {</span>
<span class="s2">//                    questionID = (int) rowIQC.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    criteriaID = (int) rowIQC.getCell(2,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    qcSet.add(new Pair&lt;&gt;(questionID, criteriaID));</span>
<span class="s2">//                    iqcMap.put(inputModel.getInputID(), qcSet);</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* get activities of the input for a sub-logframe */</span>
<span class="s2">//            Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; siaMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            long parentID, childID, activityID;</span>
<span class="s2">//</span>
<span class="s2">//            for (Row rowOI : iaSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowOI.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                inputID = (int) rowOI.getCell(2, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (inputModel.getInputID() == inputID) {</span>
<span class="s2">//                    Set&lt;Pair&lt;Long, Long&gt;&gt; activitySet = new HashSet&lt;&gt;();</span>
<span class="s2">//                    parentID = (int) rowOI.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    childID = (int) rowOI.getCell(1, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    activityID = (int) rowOI.getCell(3, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    activitySet.add(new Pair(inputID, activityID));</span>
<span class="s2">//                    siaMap.put(activitySet, new Pair&lt;&gt;(parentID, childID));</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* human input */</span>
<span class="s2">//            int humanID = -1, humanQuantity = 0;</span>
<span class="s2">//            /* human set input */</span>
<span class="s2">//            Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt; huSet = new HashSet&lt;&gt;();</span>
<span class="s2">//</span>
<span class="s2">//            /* material input */</span>
<span class="s2">//            int materialID = -1, materialQuantity = 0;</span>
<span class="s2">//</span>
<span class="s2">//            /* expense inputs */</span>
<span class="s2">//            int expenseID = -1;</span>
<span class="s2">//            double expense = 0.0;</span>
<span class="s2">//</span>
<span class="s2">//            /* income inputs */</span>
<span class="s2">//            int incomeID = -1, funderID = -1;</span>
<span class="s2">//            double fund = 0.0;</span>
<span class="s2">//</span>
<span class="s2">//            for (Row rowHuman : humanSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowHuman.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                humanID = (int) rowHuman.getCell(0, Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (inputModel.getInputID() == humanID) {</span>
<span class="s2">//                    humanQuantity = (int) rowHuman.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//</span>
<span class="s2">//                    /* human set input */</span>
<span class="s2">//                    long humanSetInputID = -1, humanSetID = -1, userID = -1;</span>
<span class="s2">//</span>
<span class="s2">//                    for (Row rowHumanSet : humanSetSheet) {</span>
<span class="s2">//                        //just skip the row if row number is 0</span>
<span class="s2">//                        if (rowHumanSet.getRowNum() == 0) {</span>
<span class="s2">//                            continue;</span>
<span class="s2">//                        }</span>
<span class="s2">//</span>
<span class="s2">//                        humanSetInputID = (int) rowHumanSet.getCell(1,</span>
<span class="s2">//                                Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                        if (inputModel.getInputID() == humanSetInputID) {</span>
<span class="s2">//                            humanSetID = (int) rowHumanSet.getCell(0,</span>
<span class="s2">//                                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                            userID = (int) rowHumanSet.getCell(2,</span>
<span class="s2">//                                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                            huSet.add(new Pair&lt;&gt;(humanSetID, userID));</span>
<span class="s2">//                        }</span>
<span class="s2">//                    }</span>
<span class="s2">//</span>
<span class="s2">//                    break;</span>
<span class="s2">//                } else {</span>
<span class="s2">//                    humanID = -1;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            hiuMap.put(inputModel.getInputID(), huSet);</span>
<span class="s2">//</span>
<span class="s2">//            /* material input */</span>
<span class="s2">//            for (Row rowMaterial : materialSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowMaterial.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                materialID = (int) rowMaterial.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (inputModel.getInputID() == materialID) {</span>
<span class="s2">//                    materialQuantity = (int) rowMaterial.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    break;</span>
<span class="s2">//                } else {</span>
<span class="s2">//                    materialID = -1;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* income input */</span>
<span class="s2">//            Map&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaMap = new HashMap&lt;&gt;();</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Double&gt;&gt; fundSet = new HashSet&lt;&gt;();</span>
<span class="s2">//            long fundInputID, fundID = -1;</span>
<span class="s2">//            double amount;</span>
<span class="s2">//            for (Row rowIncome : incomeSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowIncome.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                incomeID = (int) rowIncome.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//</span>
<span class="s2">//                if (inputModel.getInputID() == incomeID) {</span>
<span class="s2">//</span>
<span class="s2">//                    for (Row rowFundSet : fundSheet) {</span>
<span class="s2">//                        //just skip the row if row number is 0</span>
<span class="s2">//                        if (rowFundSet.getRowNum() == 0) {</span>
<span class="s2">//                            continue;</span>
<span class="s2">//                        }</span>
<span class="s2">//</span>
<span class="s2">//                        fundInputID = (int) rowFundSet.getCell(1,</span>
<span class="s2">//                                Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                        if (inputModel.getInputID() == fundInputID) {</span>
<span class="s2">//                            fundID = (int) rowFundSet.getCell(0,</span>
<span class="s2">//                                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                            funderID = (int) rowFundSet.getCell(2,</span>
<span class="s2">//                                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                            fund = (double) rowFundSet.getCell(3,</span>
<span class="s2">//                                    Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//</span>
<span class="s2">//                            fundSet.add(new Pair&lt;Long, Double&gt;((long) funderID, fund));</span>
<span class="s2">//                        }</span>
<span class="s2">//                    }</span>
<span class="s2">//                    ffaMap.put(fundID, fundSet);</span>
<span class="s2">//</span>
<span class="s2">//                    break;</span>
<span class="s2">//                } else {</span>
<span class="s2">//                    incomeID = -1;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            /* expense input */</span>
<span class="s2">//            for (Row rowExpense : expenseSheet) {</span>
<span class="s2">//                //just skip the row if row number is 0</span>
<span class="s2">//                if (rowExpense.getRowNum() == 0) {</span>
<span class="s2">//                    continue;</span>
<span class="s2">//                }</span>
<span class="s2">//</span>
<span class="s2">//                expenseID = (int) rowExpense.getCell(0,</span>
<span class="s2">//                        Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                if (inputModel.getInputID() == expenseID) {</span>
<span class="s2">//                    expense = (int) rowExpense.getCell(1,</span>
<span class="s2">//                            Row.CREATE_NULL_AS_BLANK).getNumericCellValue();</span>
<span class="s2">//                    break;</span>
<span class="s2">//                } else {</span>
<span class="s2">//                    expenseID = -1;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            if (!addInput(inputModel,</span>
<span class="s2">//                    iqcMap, siaMap,</span>
<span class="s2">//                    humanID, humanQuantity, hiuMap,</span>
<span class="s2">//                    materialID, materialQuantity,</span>
<span class="s2">//                    incomeID, ffaMap,</span>
<span class="s2">//                    expenseID, expense)) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param inputModel input model</span>
<span class="s2">//     * @param iqcMap     input question criteria</span>
<span class="s2">//     * @param siaMap     sub-logframe input activity</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    private boolean addInput(cInputModel inputModel,</span>
<span class="s2">//                             Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; iqcMap,</span>
<span class="s2">//                             Map&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; siaMap,</span>
<span class="s2">//                             long humanID, int humanQuantity,</span>
<span class="s2">//                             Map&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuMap,</span>
<span class="s2">//                             long materialID, int materialQuantity,</span>
<span class="s2">//                             long incomeID, Map&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaMap,</span>
<span class="s2">//                             long expenseID, double expense) {</span>
<span class="s2">//</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, inputModel.getInputID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_WORKPLAN_FK_ID, inputModel.getWorkplanID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_LOGFRAME_FK_ID, inputModel.getLogFrameID());</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_RESOURCE_FK_ID, inputModel.getResourceID());</span>
<span class="s2">//</span>
<span class="s2">//        // insert project details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblINPUT, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add activity, question and criteria tuple</span>
<span class="s2">//            for (Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; iqcEntry : iqcMap.entrySet()) {</span>
<span class="s2">//                long inputID = iqcEntry.getKey();</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; qcPair : iqcEntry.getValue()) {</span>
<span class="s2">//                    long questionID = qcPair.first;</span>
<span class="s2">//                    long criteriaID = qcPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addInputQuestionCriteria(inputID, questionID, criteriaID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add sub-logFrame, activity and output tuple</span>
<span class="s2">//            for (Map.Entry&lt;Set&lt;Pair&lt;Long, Long&gt;&gt;, Pair&lt;Long, Long&gt;&gt; siaEntry :</span>
<span class="s2">//                    siaMap.entrySet()) {</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; iaPair : siaEntry.getKey()) {</span>
<span class="s2">//                    long inputID = iaPair.first;</span>
<span class="s2">//                    long activityID = iaPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    Pair&lt;Long, Long&gt; sPair = siaEntry.getValue();</span>
<span class="s2">//                    long parentID = sPair.first;</span>
<span class="s2">//                    long childID = sPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addInputActivity(parentID, childID, inputID, activityID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            if (humanID != -1) {</span>
<span class="s2">//                return addHumanInput(inputModel.getInputID(), humanQuantity, hiuMap);</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            if (materialID != -1) {</span>
<span class="s2">//                return addMaterialInput(inputModel.getInputID(), materialQuantity);</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            if (incomeID != -1) {</span>
<span class="s2">//                return addIncomeInput(inputModel.getInputID(), ffaMap);</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            if (expenseID != -1) {</span>
<span class="s2">//                return addExpenseInput(inputModel.getInputID(), expense);</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing INPUT from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    /**</span>
<span class="s2">//     * @param inputID    input identification</span>
<span class="s2">//     * @param questionID question identification</span>
<span class="s2">//     * @param criteriaID criteria identification</span>
<span class="s2">//     * @return boolean</span>
<span class="s2">//     */</span>
<span class="s2">//    private boolean addInputQuestionCriteria(long inputID, long questionID, long criteriaID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_QUESTION_FK_ID, questionID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_EVALUATION_CRITERIA_FK_ID, criteriaID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblINPUT_QUESTION, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    private boolean addInputActivity(long parentID, long childID, long inputID, long activityID) {</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_PARENT_FK_ID, parentID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_CHILD_FK_ID, childID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_WORKPLAN_FK_ID, activityID);</span>
<span class="s2">//</span>
<span class="s2">//        return db.insert(cSQLDBHelper.TABLE_tblINPUT_ACTIVITY, null, cv) &gt;= 0;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    private boolean addHumanInput(long inputID, int humanQuantity, Map&lt;Long,</span>
<span class="s2">//            Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuMap) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_QUANTITY, humanQuantity);</span>
<span class="s2">//</span>
<span class="s2">//        // insert evaluation type details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblHUMAN, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add activity, question and criteria tuple</span>
<span class="s2">//            for (Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Long&gt;&gt;&gt; hiuEntry : hiuMap.entrySet()) {</span>
<span class="s2">//                long hsInputID = hiuEntry.getKey();</span>
<span class="s2">//                for (Pair&lt;Long, Long&gt; huPair : hiuEntry.getValue()) {</span>
<span class="s2">//                    long humanSetID = huPair.first;</span>
<span class="s2">//                    long userID = huPair.second;</span>
<span class="s2">//</span>
<span class="s2">//                    if (!addHumanSet(humanSetID, hsInputID, userID))</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing HUMAN INPUT from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    private boolean addHumanSet(long humanSetID, long hsInputID, long userID) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, humanSetID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, hsInputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_USER_FK_ID, userID);</span>
<span class="s2">//</span>
<span class="s2">//        // insert evaluation type details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblHUMANSET, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing HUMAN SET from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    private boolean addMaterialInput(long inputID, int materialQuantity) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_QUANTITY, materialQuantity);</span>
<span class="s2">//</span>
<span class="s2">//        // insert evaluation type details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblMATERIAL, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing MATERIAL INPUT from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    private boolean addIncomeInput(long inputID, Map&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaMap) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
<span class="s2">//        //cv.put(cSQLDBHelper.KEY_FUNDER_FK_ID, funderID);</span>
<span class="s2">//        //cv.put(cSQLDBHelper.KEY_INCOME, income);</span>
<span class="s2">//        // insert evaluation type details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblINCOME, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//</span>
<span class="s2">//            // add fundID, inputID, funderID and amount/fund tuple</span>
<span class="s2">//            Gson gson = new Gson();</span>
<span class="s2">//            for (Map.Entry&lt;Long, Set&lt;Pair&lt;Long, Double&gt;&gt;&gt; ffaEntry : ffaMap.entrySet()) {</span>
<span class="s2">//                long fundID = ffaEntry.getKey();</span>
<span class="s2">//                for (Pair&lt;Long, Double&gt; ifPair : ffaEntry.getValue()) {</span>
<span class="s2">//                    long funderID = ifPair.first;</span>
<span class="s2">//                    double fund = ifPair.second;</span>
<span class="s2">//                    if (!addFund(fundID, inputID, funderID, fund)) {</span>
<span class="s2">//                        return false;</span>
<span class="s2">//                    }</span>
<span class="s2">//                }</span>
<span class="s2">//            }</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing INCOME INPUT from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    private boolean addFund(long fundID, long inputID, long funderID, double fund) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_ID, fundID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_FUNDER_FK_ID, funderID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_FUND, fund);</span>
<span class="s2">//</span>
<span class="s2">//        // insert evaluation type details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblFUND, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing FUND from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    private boolean addExpenseInput(long inputID, double amount) {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // create content object for storing data</span>
<span class="s2">//        ContentValues cv = new ContentValues();</span>
<span class="s2">//</span>
<span class="s2">//        // assign values to the table fields</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_INPUT_FK_ID, inputID);</span>
<span class="s2">//        cv.put(cSQLDBHelper.KEY_EXPENSE, amount);</span>
<span class="s2">//</span>
<span class="s2">//        // insert evaluation type details</span>
<span class="s2">//        try {</span>
<span class="s2">//            if (db.insert(cSQLDBHelper.TABLE_tblEXPENSE, null, cv) &lt; 0) {</span>
<span class="s2">//                return false;</span>
<span class="s2">//            }</span>
<span class="s2">//        } catch (Exception e) {</span>
<span class="s2">//            Log.d(TAG, &quot;Exception in importing EXPENSE INPUT from Excel: &quot; + e.getMessage());</span>
<span class="s2">//        }</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return true;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteInputQuestions() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblINPUT_QUESTION, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteInputActivities() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblINPUT_ACTIVITY, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteHumans() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblHUMAN, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteHumanSets() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblHUMANSET, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteMaterials() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblMATERIAL, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteIncomes() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblINCOME, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteFunds() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblFUND, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteExpenses() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblEXPENSE, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s2">//</span>
<span class="s2">//    @Override</span>
<span class="s2">//    public boolean deleteInputs() {</span>
<span class="s2">//        // open the connection to the database</span>
<span class="s2">//        SQLiteDatabase db = dbHelper.getWritableDatabase();</span>
<span class="s2">//</span>
<span class="s2">//        // delete all records</span>
<span class="s2">//        long result = db.delete(cSQLDBHelper.TABLE_tblINPUT, null, null);</span>
<span class="s2">//</span>
<span class="s2">//        // close the database connection</span>
<span class="s2">//        db.close();</span>
<span class="s2">//</span>
<span class="s2">//        return result &gt; -1;</span>
<span class="s2">//    }</span>
<span class="s1">}</span>
</pre>
</body>
</html>